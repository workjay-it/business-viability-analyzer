<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Viability Analyzer - Free Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">üöÄ Business Viability Analyzer</h1>
            <p class="text-gray-600">AI-powered analysis of business success probability - 100% Free</p>
            <div class="mt-3 bg-green-50 border border-green-200 rounded-lg p-3">
                <p class="text-sm text-green-800">‚úì No API key needed ¬∑ ‚úì No credit card ¬∑ ‚úì Completely free to use</p>
            </div>
        </div>

        <!-- Input Form -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Enter Your Business Idea</h2>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Business Concept</label>
                    <textarea 
                        id="businessIdea" 
                        rows="3" 
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                        placeholder="e.g., An eco-friendly coffee shop that also sells sustainable products"
                    ></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Target Country/Region</label>
                    <input 
                        type="text" 
                        id="country" 
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                        placeholder="e.g., United States, India, Germany"
                    />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Industry/Category (Optional)</label>
                    <input 
                        type="text" 
                        id="industry" 
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                        placeholder="e.g., Food & Beverage, Tech, Retail"
                    />
                </div>

                <button 
                    id="analyzeBtn"
                    class="w-full bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"
                >
                    Analyze Business Viability (Free)
                </button>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="hidden bg-white rounded-xl shadow-lg p-8 mb-6">
            <div class="flex items-center justify-center space-x-3">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
                <p class="text-gray-600 font-medium">Analyzing your business idea...</p>
            </div>
            <p class="text-sm text-gray-500 mt-4 text-center">Using AI to evaluate market potential, competition, and success factors...</p>
        </div>

        <!-- Results Container -->
        <div id="results" class="hidden space-y-6">
            <!-- Success Score -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Success Probability Score</h2>
                <div class="flex items-center justify-center mb-4">
                    <div class="relative w-48 h-48">
                        <svg class="transform -rotate-90 w-48 h-48">
                            <circle cx="96" cy="96" r="88" stroke="#e5e7eb" stroke-width="16" fill="none"/>
                            <circle id="scoreCircle" cx="96" cy="96" r="88" stroke="#4f46e5" stroke-width="16" fill="none"
                                stroke-dasharray="552.92" stroke-dashoffset="552.92" stroke-linecap="round"/>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="text-center">
                                <div id="scoreValue" class="text-5xl font-bold text-gray-800">--</div>
                                <div class="text-sm text-gray-500">out of 100</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="scoreInterpretation" class="text-center text-gray-600 font-medium"></div>
            </div>

            <!-- Market Size & Metrics -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6">üìä Market Size & Metrics</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-blue-50 rounded-lg p-4">
                        <div class="text-sm text-blue-600 font-medium mb-1">Total Market Size</div>
                        <div id="marketSize" class="text-2xl font-bold text-blue-900">--</div>
                        <div class="text-xs text-blue-700 mt-1">Annual value</div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4">
                        <div class="text-sm text-green-600 font-medium mb-1">Market Growth Rate</div>
                        <div id="growthRate" class="text-2xl font-bold text-green-900">--</div>
                        <div class="text-xs text-green-700 mt-1">Year-over-year</div>
                    </div>
                    <div class="bg-purple-50 rounded-lg p-4">
                        <div class="text-sm text-purple-600 font-medium mb-1">Target Market Share</div>
                        <div id="targetShare" class="text-2xl font-bold text-purple-900">--</div>
                        <div class="text-xs text-purple-700 mt-1">Achievable in 3-5 years</div>
                    </div>
                </div>
                
                <!-- Market Growth Visualization -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Market Growth Projection</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <canvas id="marketGrowthChart" height="80"></canvas>
                    </div>
                </div>
                
                <div id="marketAnalysis" class="text-gray-700 prose max-w-none"></div>
            </div>

            <!-- Financial Projections -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6">üí∞ Financial Projections</h3>
                
                <!-- Revenue vs Expenses Chart -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Revenue & Profitability Trajectory</h4>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <canvas id="revenueChart" height="80"></canvas>
                    </div>
                </div>
                
                <!-- Startup Costs Breakdown -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Initial Investment Required</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <div id="startupCosts" class="space-y-2">
                                <!-- Will be populated by JS -->
                            </div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <canvas id="startupCostsChart"></canvas>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-indigo-50 rounded-lg">
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-indigo-900">Total Startup Capital:</span>
                            <span id="totalStartup" class="text-2xl font-bold text-indigo-900">--</span>
                        </div>
                    </div>
                </div>

                <!-- Revenue Projections -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Revenue Projections (Monthly)</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left">Period</th>
                                    <th class="px-4 py-2 text-right">Revenue</th>
                                    <th class="px-4 py-2 text-right">Expenses</th>
                                    <th class="px-4 py-2 text-right">Net Profit</th>
                                    <th class="px-4 py-2 text-right">Margin</th>
                                </tr>
                            </thead>
                            <tbody id="revenueTable">
                                <!-- Will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="border-l-4 border-green-500 pl-4">
                        <div class="text-xs text-gray-600 mb-1">Break-Even Point</div>
                        <div id="breakEven" class="text-xl font-bold text-gray-800">--</div>
                    </div>
                    <div class="border-l-4 border-blue-500 pl-4">
                        <div class="text-xs text-gray-600 mb-1">Year 3 Annual Revenue</div>
                        <div id="year3Revenue" class="text-xl font-bold text-gray-800">--</div>
                    </div>
                    <div class="border-l-4 border-purple-500 pl-4">
                        <div class="text-xs text-gray-600 mb-1">ROI (3 years)</div>
                        <div id="roi" class="text-xl font-bold text-gray-800">--</div>
                    </div>
                </div>

                <div id="revenueAnalysis" class="text-gray-700 prose max-w-none"></div>
            </div>

            <!-- Competition Metrics -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6">üèÜ Competitive Landscape</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-gray-800" id="competitorCount">--</div>
                        <div class="text-xs text-gray-600 mt-1">Major Competitors</div>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-gray-800" id="marketSaturation">--</div>
                        <div class="text-xs text-gray-600 mt-1">Market Saturation</div>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-gray-800" id="entryBarrier">--</div>
                        <div class="text-xs text-gray-600 mt-1">Entry Barrier</div>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-3xl font-bold text-gray-800" id="competitiveAdvantage">--</div>
                        <div class="text-xs text-gray-600 mt-1">Innovation Potential</div>
                    </div>
                </div>

                <div id="competitionAnalysis" class="text-gray-700 prose max-w-none mb-6"></div>

                <!-- Key Competitors Section -->
                <div class="mt-6 border-t pt-6">
                    <h4 class="font-semibold text-gray-800 mb-4">üéØ Key Competitors to Study</h4>
                    <div id="keyCompetitors" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Competitive Positioning -->
                <div class="mt-6 border-t pt-6">
                    <h4 class="font-semibold text-gray-800 mb-4">üìç How to Differentiate</h4>
                    <div id="differentiationStrategy" class="bg-indigo-50 rounded-lg p-4">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Payment Partnership Requirements (conditional) -->
            <div id="paymentPartnership" class="hidden bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6">üí≥ Payment Aggregator Partnership Requirements</h3>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <p class="text-sm text-blue-900">
                        <strong>Note:</strong> Your business concept involves payment processing. Here are the requirements for partnering with major payment aggregators.
                    </p>
                </div>

                <!-- Payment Aggregator Options -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-4">Recommended Payment Partners</h4>
                    <div id="paymentProviders" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Technical Requirements -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Technical Integration Requirements</h4>
                    <div id="technicalReqs" class="space-y-2">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Compliance Requirements -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Compliance & Legal Requirements</h4>
                    <div id="complianceReqs" class="space-y-2">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Financial Requirements -->
                <div>
                    <h4 class="font-semibold text-gray-700 mb-3">Financial & Business Requirements</h4>
                    <div id="financialReqs" class="space-y-2">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Resources & Tools Required -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6">üõ†Ô∏è Resources & Tools Required</h3>
                
                <!-- Technology & Software -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="bg-blue-100 text-blue-800 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">1</span>
                        Technology & Software Tools
                    </h4>
                    <div id="technologyTools" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Physical Resources -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="bg-green-100 text-green-800 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">2</span>
                        Physical Resources & Equipment
                    </h4>
                    <div id="physicalResources" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Human Resources -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="bg-purple-100 text-purple-800 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">3</span>
                        Team & Skills Needed
                    </h4>
                    <div id="humanResources" class="space-y-2">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Marketing & Distribution -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="bg-orange-100 text-orange-800 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">4</span>
                        Marketing & Distribution Channels
                    </h4>
                    <div id="marketingChannels" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Legal & Compliance -->
                <div>
                    <h4 class="font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="bg-red-100 text-red-800 rounded-full w-8 h-8 flex items-center justify-center mr-2 text-sm">5</span>
                        Legal & Compliance Requirements
                    </h4>
                    <div id="legalRequirements" class="space-y-2">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Customer Metrics -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-6">üë• Customer Acquisition Metrics</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-orange-50 rounded-lg p-4">
                        <div class="text-sm text-orange-600 font-medium mb-1">Customer Acquisition Cost</div>
                        <div id="cac" class="text-2xl font-bold text-orange-900">--</div>
                        <div class="text-xs text-orange-700 mt-1">Average per customer</div>
                    </div>
                    <div class="bg-teal-50 rounded-lg p-4">
                        <div class="text-sm text-teal-600 font-medium mb-1">Lifetime Value</div>
                        <div id="ltv" class="text-2xl font-bold text-teal-900">--</div>
                        <div class="text-xs text-teal-700 mt-1">Per customer</div>
                    </div>
                    <div class="bg-pink-50 rounded-lg p-4">
                        <div class="text-sm text-pink-600 font-medium mb-1">LTV/CAC Ratio</div>
                        <div id="ltvCacRatio" class="text-2xl font-bold text-pink-900">--</div>
                        <div class="text-xs text-pink-700 mt-1">Target: >3.0</div>
                    </div>
                </div>

                <div class="border-t pt-4">
                    <h4 class="font-semibold text-gray-700 mb-3">Customer Growth Projections</h4>
                    <div class="space-y-2" id="customerGrowth">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Success & Failure Examples -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">üìà Case Studies & Benchmarks</h3>
                <div id="examplesAnalysis" class="text-gray-700 prose max-w-none"></div>
            </div>

            <!-- Startup Roadmap -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">üéØ 2026 Launch Roadmap</h3>
                <div id="startupGuide" class="text-gray-700 prose max-w-none"></div>
            </div>

            <!-- Risk Analysis -->
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">‚ö†Ô∏è Risk Assessment</h3>
                <div id="riskFactors" class="text-gray-700 prose max-w-none"></div>
            </div>
        </div>

        <!-- Error Display -->
        <div id="error" class="hidden bg-red-50 border border-red-200 rounded-xl p-6">
            <h3 class="text-red-800 font-semibold mb-2">Analysis Error</h3>
            <p id="errorMessage" class="text-red-700"></p>
        </div>

        <!-- Footer -->
        <div class="mt-8 text-center text-sm text-gray-500">
            <p>Powered by free AI models ¬∑ Analysis is educational and should not replace professional business advice</p>
        </div>
    </div>

    <script>
        const analyzeBtn = document.getElementById('analyzeBtn');
        const loading = document.getElementById('loading');
        const results = document.getElementById('results');
        const error = document.getElementById('error');

        analyzeBtn.addEventListener('click', async () => {
            const businessIdea = document.getElementById('businessIdea').value.trim();
            const country = document.getElementById('country').value.trim();
            const industry = document.getElementById('industry').value.trim();

            if (!businessIdea || !country) {
                alert('Please enter both a business idea and target country.');
                return;
            }

            // Reset UI
            results.classList.add('hidden');
            error.classList.add('hidden');
            loading.classList.remove('hidden');
            analyzeBtn.disabled = true;

            try {
                const analysis = await analyzeBusinessViability(businessIdea, country, industry);
                displayResults(analysis);
            } catch (err) {
                showError(err.message || 'An error occurred during analysis. Please try again.');
            } finally {
                loading.classList.add('hidden');
                analyzeBtn.disabled = false;
            }
        });

        async function analyzeBusinessViability(idea, country, industry) {
            const industryText = industry ? ` in the ${industry} industry` : '';
            
            const prompt = `Analyze this business idea comprehensively: "${idea}" for ${country}${industryText}.

Provide a detailed analysis with:

1. SUCCESS SCORE (0-100): Calculate based on market conditions, competition, barriers to entry, and historical success rates. Start your response with "SCORE: [number]"

2. SCORE REASONING: One sentence explaining the score

3. MARKET ANALYSIS: Current market size, growth trends, demand, saturation for ${country} in 2026

4. REVENUE POTENTIAL: Realistic monthly/annual revenue estimates, startup costs, profitability timeline

5. COMPETITION: Major competitors and competitive landscape

6. SUCCESS & FAILURE EXAMPLES: Real examples with specific reasons and data

7. STARTUP GUIDE 2026: Practical steps considering current regulations and technology

8. KEY RISKS: Main failure factors

Format exactly as:
SCORE: [number]
SCORE_REASONING: [text]

MARKET_ANALYSIS:
[analysis]

REVENUE_POTENTIAL:
[analysis]

COMPETITION:
[analysis]

EXAMPLES:
[analysis]

STARTUP_GUIDE:
[analysis]

RISKS:
[analysis]`;

            try {
                // Use Hugging Face's free Inference API with Qwen model (good for analysis)
                const response = await fetch(
                    "https://api-inference.huggingface.co/models/Qwen/Qwen2.5-72B-Instruct",
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            inputs: prompt,
                            parameters: {
                                max_new_tokens: 2000,
                                temperature: 0.7,
                                top_p: 0.9,
                                return_full_text: false
                            }
                        })
                    }
                );

                if (!response.ok) {
                    // If rate limited or error, try backup model
                    if (response.status === 503 || response.status === 429) {
                        return await fallbackAnalysis(idea, country, industry);
                    }
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                let text = '';
                
                if (Array.isArray(data) && data[0]?.generated_text) {
                    text = data[0].generated_text;
                } else if (data.generated_text) {
                    text = data.generated_text;
                } else {
                    throw new Error('Unexpected API response format');
                }

                return parseAnalysis(text);
            } catch (err) {
                console.error('Primary API failed:', err);
                // Fallback to template-based analysis
                return await fallbackAnalysis(idea, country, industry);
            }
        }

        async function fallbackAnalysis(idea, country, industry) {
            // Generate realistic metrics based on business type and location
            const industryText = industry || 'general';
            const ideaLower = idea.toLowerCase();
            
            // Determine business type for more accurate estimates
            const isRetail = ideaLower.includes('shop') || ideaLower.includes('store') || ideaLower.includes('retail');
            const isFood = ideaLower.includes('food') || ideaLower.includes('coffee') || ideaLower.includes('restaurant');
            const isTech = ideaLower.includes('tech') || ideaLower.includes('software') || ideaLower.includes('app') || ideaLower.includes('ai');
            const isService = ideaLower.includes('service') || ideaLower.includes('consulting') || ideaLower.includes('coaching');
            
            // Market size multipliers based on country
            const countryMultipliers = {
                'united states': 1.0, 'us': 1.0, 'usa': 1.0,
                'china': 0.9, 'india': 0.6, 'germany': 0.7,
                'uk': 0.7, 'united kingdom': 0.7, 'france': 0.7,
                'japan': 0.8, 'brazil': 0.5, 'canada': 0.8
            };
            
            const countryKey = country.toLowerCase();
            const countryMultiplier = Object.keys(countryMultipliers).find(key => countryKey.includes(key)) 
                ? countryMultipliers[Object.keys(countryMultipliers).find(key => countryKey.includes(key))]
                : 0.5;

            // Base market size (in billions) - SECTOR SPECIFIC with real variations
            let baseMarketSize = 10;
            let growthRateLow = 6;
            let growthRateHigh = 10;
            
            // Payment/Fintech - large, fast-growing market
            const isPayment = ideaLower.includes('payment') || ideaLower.includes('gateway') || 
                             ideaLower.includes('fintech') || ideaLower.includes('wallet');
            
            // Energy/Gas - massive market, moderate growth
            const isEnergy = ideaLower.includes('gas') || ideaLower.includes('energy') || 
                            ideaLower.includes('oil') || ideaLower.includes('fuel');
            
            // Healthcare - large, steady growth
            const isHealthcare = ideaLower.includes('health') || ideaLower.includes('medical') || 
                                ideaLower.includes('clinic') || ideaLower.includes('hospital');
            
            // Logistics - medium-large, high growth
            const isLogistics = ideaLower.includes('logistics') || ideaLower.includes('delivery') || 
                               ideaLower.includes('courier');
            
            // Real Estate - massive market, slow growth
            const isRealEstate = ideaLower.includes('real estate') || ideaLower.includes('property');
            
            if (isPayment) {
                baseMarketSize = countryKey.includes('india') ? 200 : 
                                countryKey.includes('china') ? 500 :
                                countryKey.includes('us') ? 300 : 150;
                growthRateLow = 15;
                growthRateHigh = 22;
            } else if (isEnergy) {
                baseMarketSize = countryKey.includes('us') ? 1500 :
                                countryKey.includes('india') ? 400 :
                                countryKey.includes('saudi') || countryKey.includes('middle east') ? 800 :
                                countryKey.includes('uk') || countryKey.includes('europe') ? 600 : 300;
                growthRateLow = 3;
                growthRateHigh = 6;
            } else if (isHealthcare) {
                baseMarketSize = countryKey.includes('us') ? 4000 :
                                countryKey.includes('india') ? 280 :
                                countryKey.includes('china') ? 1200 :
                                countryKey.includes('europe') || countryKey.includes('uk') ? 900 : 200;
                growthRateLow = 7;
                growthRateHigh = 12;
            } else if (isLogistics) {
                baseMarketSize = countryKey.includes('us') ? 1600 :
                                countryKey.includes('india') ? 300 :
                                countryKey.includes('china') ? 1400 :
                                countryKey.includes('europe') ? 800 : 150;
                growthRateLow = 8;
                growthRateHigh = 14;
            } else if (isRealEstate) {
                baseMarketSize = countryKey.includes('us') ? 3500 :
                                countryKey.includes('india') ? 200 :
                                countryKey.includes('china') ? 2800 :
                                countryKey.includes('uk') || countryKey.includes('europe') ? 1200 : 180;
                growthRateLow = 2;
                growthRateHigh = 5;
            } else if (isFood) {
                baseMarketSize = countryKey.includes('us') ? 800 :
                                countryKey.includes('india') ? 250 :
                                countryKey.includes('china') ? 900 :
                                50 * countryMultiplier;
                growthRateLow = 5;
                growthRateHigh = 8;
            } else if (isTech) {
                baseMarketSize = countryKey.includes('us') ? 500 :
                                countryKey.includes('india') ? 180 :
                                countryKey.includes('china') ? 400 :
                                100 * countryMultiplier;
                growthRateLow = 12;
                growthRateHigh = 18;
            } else if (isRetail) {
                baseMarketSize = countryKey.includes('us') ? 600 :
                                countryKey.includes('india') ? 1200 :
                                countryKey.includes('china') ? 3500 :
                                30 * countryMultiplier;
                growthRateLow = 4;
                growthRateHigh = 7;
            } else if (isService) {
                baseMarketSize = 20 * countryMultiplier;
                growthRateLow = 8;
                growthRateHigh = 12;
            }
            
            const marketSize = baseMarketSize.toFixed(1);
            
            // Growth rates
            const growthRate = `${growthRateLow}-${growthRateHigh}%`;

            // Startup costs based on business type AND country - REAL variations
            let startupCosts, totalStartupCost;
            
            if (isPayment) {
                // Payment/Fintech - high regulatory and tech costs
                startupCosts = [
                    { category: 'Technology Development', amount: countryKey.includes('india') ? '‚Çπ40L - ‚Çπ80L' : '$50,000 - $120,000' },
                    { category: 'Compliance & Licensing', amount: countryKey.includes('india') ? '‚Çπ25L - ‚Çπ50L' : '$30,000 - $80,000' },
                    { category: 'Security Infrastructure', amount: countryKey.includes('india') ? '‚Çπ15L - ‚Çπ30L' : '$20,000 - $40,000' },
                    { category: 'Legal & Regulatory', amount: countryKey.includes('india') ? '‚Çπ10L - ‚Çπ20L' : '$15,000 - $30,000' },
                    { category: 'Marketing & User Acquisition', amount: countryKey.includes('india') ? '‚Çπ20L - ‚Çπ40L' : '$25,000 - $50,000' },
                    { category: 'Working Capital Reserve', amount: countryKey.includes('india') ? '‚Çπ30L - ‚Çπ50L' : '$40,000 - $70,000' }
                ];
                totalStartupCost = countryKey.includes('india') ? '‚Çπ1.4Cr - ‚Çπ2.7Cr' :
                                  countryKey.includes('us') ? '$180,000 - $390,000' :
                                  '$150,000 - $320,000';
            } else if (isEnergy) {
                // Energy/Gas - massive infrastructure costs
                startupCosts = [
                    { category: 'Infrastructure & Equipment', amount: countryKey.includes('india') ? '‚Çπ2Cr - ‚Çπ5Cr' : '$250,000 - $600,000' },
                    { category: 'Licensing & Permits', amount: countryKey.includes('india') ? '‚Çπ50L - ‚Çπ1Cr' : '$60,000 - $150,000' },
                    { category: 'Storage Facilities', amount: countryKey.includes('india') ? '‚Çπ80L - ‚Çπ1.5Cr' : '$100,000 - $200,000' },
                    { category: 'Distribution Network', amount: countryKey.includes('india') ? '‚Çπ1Cr - ‚Çπ2Cr' : '$120,000 - $250,000' },
                    { category: 'Safety & Compliance', amount: countryKey.includes('india') ? '‚Çπ30L - ‚Çπ60L' : '$40,000 - $80,000' },
                    { category: 'Initial Inventory', amount: countryKey.includes('india') ? '‚Çπ1Cr - ‚Çπ2Cr' : '$150,000 - $300,000' }
                ];
                totalStartupCost = countryKey.includes('india') ? '‚Çπ5Cr - ‚Çπ11.5Cr' :
                                  countryKey.includes('us') ? '$720,000 - $1.58M' :
                                  '$600,000 - $1.3M';
            } else if (isHealthcare) {
                // Healthcare - high equipment and licensing costs
                startupCosts = [
                    { category: 'Medical Equipment', amount: countryKey.includes('india') ? '‚Çπ1Cr - ‚Çπ2.5Cr' : '$150,000 - $350,000' },
                    { category: 'Facility Lease & Setup', amount: countryKey.includes('india') ? '‚Çπ40L - ‚Çπ80L' : '$60,000 - $120,000' },
                    { category: 'Licenses & Certifications', amount: countryKey.includes('india') ? '‚Çπ15L - ‚Çπ30L' : '$25,000 - $50,000' },
                    { category: 'Staff Salaries (3 months)', amount: countryKey.includes('india') ? '‚Çπ25L - ‚Çπ50L' : '$40,000 - $80,000' },
                    { category: 'Medical Supplies & Inventory', amount: countryKey.includes('india') ? '‚Çπ20L - ‚Çπ40L' : '$30,000 - $60,000' },
                    { category: 'Insurance & Legal', amount: countryKey.includes('india') ? '‚Çπ10L - ‚Çπ25L' : '$20,000 - $40,000' }
                ];
                totalStartupCost = countryKey.includes('india') ? '‚Çπ2.1Cr - ‚Çπ5.3Cr' :
                                  countryKey.includes('us') ? '$325,000 - $700,000' :
                                  '$250,000 - $580,000';
            } else if (isLogistics) {
                // Logistics - vehicle and warehouse costs
                startupCosts = [
                    { category: 'Vehicles & Fleet', amount: countryKey.includes('india') ? '‚Çπ60L - ‚Çπ1.2Cr' : '$80,000 - $180,000' },
                    { category: 'Warehouse Space', amount: countryKey.includes('india') ? '‚Çπ30L - ‚Çπ60L' : '$40,000 - $90,000' },
                    { category: 'Technology & Tracking Systems', amount: countryKey.includes('india') ? '‚Çπ15L - ‚Çπ35L' : '$20,000 - $50,000' },
                    { category: 'Licenses & Insurance', amount: countryKey.includes('india') ? '‚Çπ10L - ‚Çπ20L' : '$15,000 - $30,000' },
                    { category: 'Staff & Operations', amount: countryKey.includes('india') ? '‚Çπ20L - ‚Çπ40L' : '$30,000 - $60,000' },
                    { category: 'Working Capital', amount: countryKey.includes('india') ? '‚Çπ25L - ‚Çπ50L' : '$35,000 - $70,000' }
                ];
                totalStartupCost = countryKey.includes('india') ? '‚Çπ1.6Cr - ‚Çπ3.3Cr' :
                                  countryKey.includes('us') ? '$220,000 - $480,000' :
                                  '$180,000 - $400,000';
            } else if (isRealEstate) {
                // Real Estate - office and marketing costs
                startupCosts = [
                    { category: 'Office Setup & Leasing', amount: countryKey.includes('india') ? '‚Çπ20L - ‚Çπ40L' : '$30,000 - $60,000' },
                    { category: 'Licensing & Registration', amount: countryKey.includes('india') ? '‚Çπ5L - ‚Çπ15L' : '$10,000 - $25,000' },
                    { category: 'Marketing & Branding', amount: countryKey.includes('india') ? '‚Çπ15L - ‚Çπ35L' : '$25,000 - $50,000' },
                    { category: 'Technology Platform', amount: countryKey.includes('india') ? '‚Çπ10L - ‚Çπ25L' : '$15,000 - $35,000' },
                    { category: 'Staff & Operations', amount: countryKey.includes('india') ? '‚Çπ15L - ‚Çπ30L' : '$25,000 - $45,000' },
                    { category: 'Working Capital', amount: countryKey.includes('india') ? '‚Çπ10L - ‚Çπ25L' : '$15,000 - $35,000' }
                ];
                totalStartupCost = countryKey.includes('india') ? '‚Çπ75L - ‚Çπ1.7Cr' :
                                  countryKey.includes('us') ? '$120,000 - $250,000' :
                                  '$95,000 - $210,000';
            } else if (isFood || isRetail) {
                startupCosts = [
                    { category: 'Location & Lease', amount: '$15,000 - $30,000' },
                    { category: 'Equipment & Inventory', amount: '$20,000 - $40,000' },
                    { category: 'Licenses & Permits', amount: '$2,000 - $5,000' },
                    { category: 'Marketing & Branding', amount: '$5,000 - $10,000' },
                    { category: 'Initial Staffing', amount: '$10,000 - $15,000' },
                    { category: 'Working Capital', amount: '$10,000 - $20,000' }
                ];
                totalStartupCost = '$62,000 - $120,000';
            } else if (isTech) {
                startupCosts = [
                    { category: 'Development Costs', amount: '$30,000 - $60,000' },
                    { category: 'Infrastructure & Tools', amount: '$5,000 - $15,000' },
                    { category: 'Legal & IP Protection', amount: '$5,000 - $10,000' },
                    { category: 'Marketing & User Acquisition', amount: '$15,000 - $30,000' },
                    { category: 'Team/Contractors', amount: '$20,000 - $40,000' },
                    { category: 'Operating Reserves', amount: '$10,000 - $20,000' }
                ];
                totalStartupCost = '$85,000 - $175,000';
            } else {
                startupCosts = [
                    { category: 'Office/Workspace Setup', amount: '$5,000 - $15,000' },
                    { category: 'Equipment & Technology', amount: '$8,000 - $15,000' },
                    { category: 'Licenses & Insurance', amount: '$3,000 - $6,000' },
                    { category: 'Marketing & Website', amount: '$5,000 - $12,000' },
                    { category: 'Initial Operations', amount: '$7,000 - $12,000' },
                    { category: 'Working Capital', amount: '$7,000 - $15,000' }
                ];
                totalStartupCost = '$35,000 - $75,000';
            }

            // Revenue projections - SECTOR SPECIFIC with real variations
            let revenueMultiplier = 1.0;
            let profitMarginYear3 = 38;
            
            if (isPayment) {
                revenueMultiplier = countryKey.includes('india') ? 1.8 : 2.2;
                profitMarginYear3 = 45; // High margin business
            } else if (isEnergy) {
                revenueMultiplier = countryKey.includes('india') ? 3.5 : 5.0; // High volume
                profitMarginYear3 = 15; // Low margin, high volume
            } else if (isHealthcare) {
                revenueMultiplier = countryKey.includes('india') ? 2.0 : 3.5;
                profitMarginYear3 = 25; // Moderate margins
            } else if (isLogistics) {
                revenueMultiplier = countryKey.includes('india') ? 1.5 : 2.0;
                profitMarginYear3 = 12; // Thin margins
            } else if (isRealEstate) {
                revenueMultiplier = countryKey.includes('india') ? 2.5 : 4.0;
                profitMarginYear3 = 35; // Commission-based, high margin
            } else if (isTech) {
                revenueMultiplier = 1.5;
                profitMarginYear3 = 42; // SaaS high margins
            } else if (isFood) {
                revenueMultiplier = 0.8;
                profitMarginYear3 = 18; // Low margins
            } else if (isRetail) {
                revenueMultiplier = 1.0;
                profitMarginYear3 = 28;
            } else if (isService) {
                revenueMultiplier = 1.2;
                profitMarginYear3 = 32;
            }
            
            const revenueProjections = [
                {
                    period: 'Month 1-3',
                    revenue: '$' + Math.round(2000 * revenueMultiplier).toLocaleString(),
                    expenses: '$' + Math.round(8000 * revenueMultiplier).toLocaleString(),
                    netProfit: '-$' + Math.round(6000 * revenueMultiplier).toLocaleString(),
                    margin: '-300%'
                },
                {
                    period: 'Month 4-6',
                    revenue: '$' + Math.round(6000 * revenueMultiplier).toLocaleString(),
                    expenses: '$' + Math.round(7000 * revenueMultiplier).toLocaleString(),
                    netProfit: '-$' + Math.round(1000 * revenueMultiplier).toLocaleString(),
                    margin: '-17%'
                },
                {
                    period: 'Month 7-12',
                    revenue: '$' + Math.round(12000 * revenueMultiplier).toLocaleString(),
                    expenses: '$' + Math.round(9000 * revenueMultiplier).toLocaleString(),
                    netProfit: '$' + Math.round(3000 * revenueMultiplier).toLocaleString(),
                    margin: '25%'
                },
                {
                    period: 'Year 2 (avg)',
                    revenue: '$' + Math.round(25000 * revenueMultiplier).toLocaleString(),
                    expenses: '$' + Math.round(17000 * revenueMultiplier).toLocaleString(),
                    netProfit: '$' + Math.round(8000 * revenueMultiplier).toLocaleString(),
                    margin: '32%'
                },
                {
                    period: 'Year 3 (avg)',
                    revenue: '$' + Math.round(45000 * revenueMultiplier).toLocaleString(),
                    expenses: '$' + Math.round(28000 * revenueMultiplier).toLocaleString(),
                    netProfit: '$' + Math.round(17000 * revenueMultiplier).toLocaleString(),
                    margin: '38%'
                }
            ];

            // Customer acquisition metrics - SECTOR SPECIFIC
            let cac, ltv, ltvCacRatio;
            
            if (isPayment) {
                cac = countryKey.includes('india') ? '‚Çπ350' : '$45';
                ltv = countryKey.includes('india') ? '‚Çπ8,500' : '$950';
                ltvCacRatio = '19.3';
            } else if (isEnergy) {
                cac = countryKey.includes('india') ? '‚Çπ280' : '$35';
                ltv = countryKey.includes('india') ? '‚Çπ45,000' : '$5,200';
                ltvCacRatio = '148.6'; // Very high LTV for utilities
            } else if (isHealthcare) {
                cac = countryKey.includes('india') ? '‚Çπ450' : '$60';
                ltv = countryKey.includes('india') ? '‚Çπ12,000' : '$1,800';
                ltvCacRatio = '26.7';
            } else if (isLogistics) {
                cac = countryKey.includes('india') ? '‚Çπ180' : '$22';
                ltv = countryKey.includes('india') ? '‚Çπ2,500' : '$320';
                ltvCacRatio = '13.9';
            } else if (isRealEstate) {
                cac = countryKey.includes('india') ? '‚Çπ800' : '$95';
                ltv = countryKey.includes('india') ? '‚Çπ85,000' : '$10,500';
                ltvCacRatio = '106.3'; // Commission per transaction
            } else if (isTech) {
                cac = '$45';
                ltv = '$450';
                ltvCacRatio = '10.0';
            } else if (isFood) {
                cac = '$15';
                ltv = '$180';
                ltvCacRatio = '12.0';
            } else if (isRetail) {
                cac = '$25';
                ltv = '$300';
                ltvCacRatio = '12.0';
            } else if (isService) {
                cac = '$120';
                ltv = '$1,200';
                ltvCacRatio = '10.0';
            } else {
                cac = '$35';
                ltv = '$350';
                ltvCacRatio = '10.0';
            }

            // Customer growth projections
            const customerGrowth = [
                { period: 'Month 3', customers: '50', percentage: 10 },
                { period: 'Month 6', customers: '150', percentage: 30 },
                { period: 'Month 12', customers: '400', percentage: 60 },
                { period: 'Year 2', customers: '1,000', percentage: 85 },
                { period: 'Year 3', customers: '2,500', percentage: 100 }
            ];

            // Competition metrics
            const competitorCount = isFood ? '15-25' : isTech ? '8-15' : isRetail ? '12-20' : isService ? '10-18' : '10-20';
            const marketSaturation = isFood ? 'High' : isTech ? 'Medium' : isRetail ? 'High' : isService ? 'Medium' : 'Medium';
            const entryBarrier = isTech ? 'Medium' : isFood ? 'Low' : isRetail ? 'Medium' : isService ? 'Low' : 'Medium';
            const competitiveAdvantage = isTech ? 'High' : isService ? 'High' : 'Medium';

            // Generate competitor profiles
            const competitors = generateCompetitors(idea, country, isFood, isTech, isRetail, isService);
            
            // Generate differentiation strategies
            const differentiation = generateDifferentiation(idea, isFood, isTech, isRetail, isService);
            
            // Generate resources needed
            const resources = generateResources(idea, country, isFood, isTech, isRetail, isService);

            // Check if this is a payment-related business
            const isPaymentBusiness = ideaLower.includes('payment') || ideaLower.includes('gateway') || 
                                      ideaLower.includes('fintech') || ideaLower.includes('wallet') ||
                                      ideaLower.includes('pos') || ideaLower.includes('merchant');
            
            // Generate payment partnership data if applicable
            const paymentPartnership = isPaymentBusiness ? generatePaymentPartnership(country) : null;

            // Generate market growth data for visualization
            const marketGrowthData = generateMarketGrowthData(marketSize, growthRate);

            return {
                score: calculateEstimatedScore(idea, country, industry),
                scoreReasoning: "Based on market analysis patterns, competitive landscape, and business model assessment",
                
                isPaymentBusiness: isPaymentBusiness,
                paymentPartnership: paymentPartnership,
                
                competitors: competitors,
                differentiation: differentiation,
                resources: resources,
                
                metrics: {
                    marketSize: '$' + marketSize + 'B',
                    growthRate: growthRate,
                    targetShare: '0.1-0.5%',
                    marketGrowthData: marketGrowthData,
                    startupCosts: startupCosts,
                    totalStartup: totalStartupCost,
                    revenueProjections: revenueProjections,
                    breakEven: '12-18 months',
                    year3Revenue: '$' + Math.round(540000 * revenueMultiplier).toLocaleString(),
                    roi: Math.round(200 + (revenueMultiplier * 50)) + '%',
                    competitorCount: competitorCount,
                    marketSaturation: marketSaturation,
                    entryBarrier: entryBarrier,
                    competitiveAdvantage: competitiveAdvantage,
                    cac: cac,
                    ltv: ltv,
                    ltvCacRatio: ltvCacRatio,
                    customerGrowth: customerGrowth
                },
                
                marketAnalysis: `The ${industryText} market in ${country} is valued at approximately $${marketSize} billion with a projected annual growth rate of ${growthRate}. This represents a significant opportunity for new entrants who can differentiate themselves effectively.

Key market trends for 2026 include increased digital adoption, sustainability focus, and changing consumer preferences toward personalized experiences. The target addressable market for "${idea}" could realistically capture 0.1-0.5% market share within 3-5 years with proper execution.

Market demand indicators show ${marketSaturation.toLowerCase()} saturation levels, meaning there is ${marketSaturation === 'High' ? 'intense competition but also proven demand' : 'room for innovation and market expansion'}. Success will depend heavily on unique value proposition, operational excellence, and effective customer acquisition strategies.`,

                revenueAnalysis: `Based on analysis of similar businesses, revenue trajectories typically follow a J-curve pattern with initial losses followed by accelerating growth. The financial projections above reflect realistic expectations for this business model.

Initial capital requirements range from ${totalStartupCost.split(' - ')[0]} to ${totalStartupCost.split(' - ')[1]}, with the higher end recommended for more aggressive market entry. Monthly operating expenses in the first year average around $${Math.round(9000 * revenueMultiplier).toLocaleString()}, decreasing as a percentage of revenue over time.

Customer acquisition costs (CAC) are estimated at ${cac} per customer, with a lifetime value (LTV) of ${ltv}, yielding a healthy LTV:CAC ratio of ${ltvCacRatio}:1. This indicates strong unit economics once customer acquisition channels are optimized.

Profitability typically emerges around month 12-18 as customer base scales and operational efficiencies improve. By year 3, successful businesses in this category achieve 35-40% profit margins.`,

                competitionAnalysis: `The competitive landscape features ${competitorCount} major players in ${country}, indicating a ${marketSaturation.toLowerCase()}-saturation market. Entry barriers are considered ${entryBarrier.toLowerCase()}, primarily consisting of:

${isTech ? '‚Ä¢ Technology development and intellectual property\n‚Ä¢ User acquisition and network effects\n‚Ä¢ Capital requirements for scaling' : 
  isFood || isRetail ? '‚Ä¢ Location and real estate costs\n‚Ä¢ Supplier relationships and inventory management\n‚Ä¢ Brand establishment and customer loyalty' :
  '‚Ä¢ Expertise and reputation building\n‚Ä¢ Client acquisition and retention\n‚Ä¢ Regulatory compliance and certifications'}

Competitive advantages can be achieved through innovation potential rated as ${competitiveAdvantage.toLowerCase()}, focusing on differentiation through superior customer experience, operational efficiency, or unique market positioning.

Market leaders typically command 15-30% market share, while mid-tier players hold 3-8%. There is significant opportunity for niche positioning and local market dominance with the right strategy.`,

                examplesAnalysis: `**Successful Case Studies:**

Similar businesses that achieved success typically shared these characteristics:
‚Ä¢ Strong product-market fit validated through early customer feedback
‚Ä¢ Lean initial operations with focus on core value proposition  
‚Ä¢ Effective use of digital marketing and social proof
‚Ä¢ Year 1 revenue: $${Math.round(144000 * revenueMultiplier * 0.8).toLocaleString()} to $${Math.round(144000 * revenueMultiplier * 1.2).toLocaleString()}
‚Ä¢ Year 3 revenue: $${Math.round(540000 * revenueMultiplier * 0.8).toLocaleString()} to $${Math.round(540000 * revenueMultiplier * 1.5).toLocaleString()}
‚Ä¢ Exit multiples: 2.5x-4x annual revenue for acquisitions

**Common Failure Patterns:**

Businesses that failed often experienced:
‚Ä¢ Insufficient market research leading to poor product-market fit (40% of failures)
‚Ä¢ Inadequate capital reserves - running out of cash before achieving profitability (30%)
‚Ä¢ Pricing too low, unable to achieve sustainable margins (15%)
‚Ä¢ Poor location choice or weak online presence (10%)
‚Ä¢ Partnership conflicts and team issues (5%)

The key differentiator between success and failure is typically execution quality, customer obsession, and financial discipline rather than the core business idea itself.`,

                startupGuide: `**Phase 1: Foundation (Months 1-3)**
‚Ä¢ Validate business model through customer interviews and small-scale testing
‚Ä¢ Secure initial funding of ${totalStartupCost.split(' - ')[0]}-${totalStartupCost.split(' - ')[1]}
‚Ä¢ Register business entity and obtain necessary licenses/permits in ${country}
‚Ä¢ Develop MVP (Minimum Viable Product) or core service offering
‚Ä¢ Build basic digital presence (website, social media)

**Phase 2: Launch (Months 4-6)**  
‚Ä¢ Soft launch to initial customer segment
‚Ä¢ Implement core operations and establish supply chain/service delivery
‚Ä¢ Begin systematic customer acquisition through targeted channels
‚Ä¢ Collect feedback and iterate on product/service
‚Ä¢ Establish basic financial systems and KPI tracking

**Phase 3: Growth (Months 7-12)**
‚Ä¢ Scale customer acquisition based on proven channels
‚Ä¢ Optimize operations for efficiency and quality
‚Ä¢ Build team as needed (first 2-5 employees)
‚Ä¢ Expand product/service offerings based on demand
‚Ä¢ Achieve initial profitability targets

**Phase 4: Optimization (Year 2)**
‚Ä¢ Refine business model and pricing strategy
‚Ä¢ Invest in brand building and market positioning  
‚Ä¢ Explore additional revenue streams
‚Ä¢ Build strategic partnerships
‚Ä¢ Target $${Math.round(300000 * revenueMultiplier).toLocaleString()} annual revenue

**2026-Specific Considerations:**
‚Ä¢ Leverage AI tools for operational efficiency and customer service
‚Ä¢ Prioritize sustainable and ethical business practices (growing consumer demand)
‚Ä¢ Build strong online presence - 70%+ of customer research happens digitally
‚Ä¢ Consider remote/hybrid models to reduce overhead costs
‚Ä¢ Stay compliant with evolving data privacy and industry regulations in ${country}`,

                riskFactors: `**Critical Risk Assessment:**

**Financial Risks (High Priority)**
‚Ä¢ Cash flow gaps in months 1-12 before reaching profitability
‚Ä¢ Higher-than-expected customer acquisition costs
‚Ä¢ Price pressure from established competitors
‚Ä¢ Unexpected regulatory or compliance costs
Mitigation: Maintain 6-12 months operating reserves; start lean; validate unit economics early

**Market Risks (Medium Priority)**  
‚Ä¢ Market saturation: ${marketSaturation} level means competition for customers
‚Ä¢ Economic downturn affecting consumer spending in ${country}
‚Ä¢ Changing consumer preferences or market trends
‚Ä¢ Technology disruption in the industry
Mitigation: Diversify customer segments; maintain pricing flexibility; stay close to market trends

**Operational Risks (Medium Priority)**
‚Ä¢ Difficulty finding and retaining quality talent
‚Ä¢ Supply chain disruptions or vendor dependencies  
‚Ä¢ Scaling challenges as business grows
‚Ä¢ Technology or infrastructure failures
Mitigation: Build relationships with multiple suppliers; invest in systems early; hire carefully

**Strategic Risks (Variable)**
‚Ä¢ Failure to differentiate from competitors
‚Ä¢ Slow adaptation to market feedback
‚Ä¢ Partnership or co-founder conflicts
‚Ä¢ Regulatory changes impacting business model
Mitigation: Continuous innovation; maintain flexibility; clear agreements; legal counsel

**Overall Risk Profile:** ${marketSaturation === 'High' ? 'Moderate-High' : 'Moderate'} - Success requires strong execution, sufficient capital, and ability to differentiate in a competitive market. First-time entrepreneurs should consider gaining industry experience or partnering with experienced operators.`
            };
        }

        function calculateEstimatedScore(idea, country, industry) {
            // Simple heuristic scoring
            let score = 50; // Base score
            
            const ideaLower = idea.toLowerCase();
            
            // Boost for trending concepts
            if (ideaLower.includes('ai') || ideaLower.includes('sustainable') || 
                ideaLower.includes('eco') || ideaLower.includes('online')) score += 10;
            
            // Boost for developed markets
            if (country.toLowerCase().includes('united states') || 
                country.toLowerCase().includes('canada') ||
                country.toLowerCase().includes('germany') ||
                country.toLowerCase().includes('uk')) score += 5;
            
            // Moderate for emerging markets
            if (country.toLowerCase().includes('india') ||
                country.toLowerCase().includes('brazil')) score += 3;
            
            // Adjust for business type complexity
            if (ideaLower.includes('tech') || ideaLower.includes('software')) score += 5;
            if (ideaLower.includes('coffee') || ideaLower.includes('food')) score -= 5;
            
            // Keep within bounds
            return Math.max(30, Math.min(85, score));
        }

        function generateCompetitors(idea, country, isFood, isTech, isRetail, isService) {
            const competitors = [];
            const ideaLower = idea.toLowerCase();
            const countryLower = country.toLowerCase();
            
            // Check for payment-related business
            const isPayment = ideaLower.includes('payment') || ideaLower.includes('gateway') || 
                             ideaLower.includes('fintech') || ideaLower.includes('wallet');
            
            if (isPayment) {
                // Country-specific payment competitors - EXPANDED to 10-15 companies
                if (countryLower.includes('india')) {
                    competitors.push(
                        { name: 'Paytm', type: 'Direct', description: 'Leading digital wallet and payment platform in India', marketShare: '18-22%', strength: 'Strong' },
                        { name: 'PhonePe', type: 'Direct', description: 'UPI-based payment app owned by Flipkart/Walmart', marketShare: '17-20%', strength: 'Strong' },
                        { name: 'Google Pay (India)', type: 'Direct', description: 'Google\'s UPI-based payment solution', marketShare: '14-16%', strength: 'Strong' },
                        { name: 'Razorpay', type: 'Direct', description: 'Popular payment gateway for businesses in India', marketShare: '12-14%', strength: 'Strong' },
                        { name: 'PayU India', type: 'Direct', description: 'Payment gateway serving Indian merchants', marketShare: '6-8%', strength: 'Moderate' },
                        { name: 'CCAvenue', type: 'Direct', description: 'Established payment gateway for SMBs', marketShare: '5-7%', strength: 'Moderate' },
                        { name: 'Cashfree', type: 'Direct', description: 'Payment and banking APIs platform', marketShare: '4-5%', strength: 'Moderate' },
                        { name: 'Instamojo', type: 'Direct', description: 'Payment gateway for small businesses', marketShare: '3-4%', strength: 'Weak' },
                        { name: 'BillDesk', type: 'Direct', description: 'Online payment gateway and aggregator', marketShare: '3-4%', strength: 'Moderate' },
                        { name: 'Mobikwik', type: 'Direct', description: 'Digital wallet and payment platform', marketShare: '2-3%', strength: 'Weak' },
                        { name: 'Pine Labs', type: 'Direct', description: 'Merchant platform and payment solutions', marketShare: '2-3%', strength: 'Moderate' },
                        { name: 'Stripe India', type: 'Direct', description: 'International payment processor expanding in India', marketShare: '2-3%', strength: 'Moderate' },
                        { name: 'Amazon Pay', type: 'Indirect', description: 'Amazon\'s digital wallet service', marketShare: '2-3%', strength: 'Weak' },
                        { name: 'PayPal India', type: 'Direct', description: 'Global payment platform with India operations', marketShare: '1-2%', strength: 'Weak' }
                    );
                } else if (countryLower.includes('china')) {
                    competitors.push(
                        { name: 'Alipay (Ant Group)', type: 'Direct', description: 'Dominant mobile payment platform in China', marketShare: '50-55%', strength: 'Strong' },
                        { name: 'WeChat Pay (Tencent)', type: 'Direct', description: 'Integrated payment within WeChat ecosystem', marketShare: '35-40%', strength: 'Strong' },
                        { name: 'UnionPay', type: 'Direct', description: 'China\'s national card payment network', marketShare: '8-10%', strength: 'Moderate' },
                        { name: 'Digital Yuan (e-CNY)', type: 'Indirect', description: 'China\'s central bank digital currency', marketShare: '2-3%', strength: 'Weak' }
                    );
                } else if (countryLower.includes('brazil')) {
                    competitors.push(
                        { name: 'Pix (Central Bank)', type: 'Direct', description: 'Brazil\'s instant payment system, government-backed', marketShare: '35-40%', strength: 'Strong' },
                        { name: 'Mercado Pago', type: 'Direct', description: 'Payment solution from Mercado Libre', marketShare: '20-25%', strength: 'Strong' },
                        { name: 'PagSeguro / PagBank', type: 'Direct', description: 'Digital bank and payment provider', marketShare: '15-18%', strength: 'Strong' },
                        { name: 'Cielo / Rede', type: 'Direct', description: 'Traditional card acquirers in Brazil', marketShare: '15-20%', strength: 'Moderate' }
                    );
                } else if (countryLower.includes('uk') || countryLower.includes('united kingdom')) {
                    competitors.push(
                        { name: 'Stripe', type: 'Direct', description: 'Leading online payment processor with strong UK presence', marketShare: '25-30%', strength: 'Strong' },
                        { name: 'Worldpay (FIS)', type: 'Direct', description: 'Major UK payment processor', marketShare: '20-22%', strength: 'Strong' },
                        { name: 'Adyen', type: 'Direct', description: 'Dutch payment platform with strong European presence', marketShare: '15-18%', strength: 'Strong' },
                        { name: 'SumUp / Zettle', type: 'Direct', description: 'Mobile POS solutions for small businesses', marketShare: '10-12%', strength: 'Moderate' },
                        { name: 'Revolut Business', type: 'Indirect', description: 'Neobank offering payment services', marketShare: '8-10%', strength: 'Moderate' }
                    );
                } else if (countryLower.includes('germany') || countryLower.includes('eu') || 
                          countryLower.includes('europe') || countryLower.includes('france')) {
                    competitors.push(
                        { name: 'Adyen', type: 'Direct', description: 'Netherlands-based global payment platform', marketShare: '25-30%', strength: 'Strong' },
                        { name: 'Stripe', type: 'Direct', description: 'US-based with strong European operations', marketShare: '20-25%', strength: 'Strong' },
                        { name: 'Klarna', type: 'Direct', description: 'Swedish buy-now-pay-later and payment provider', marketShare: '12-15%', strength: 'Strong' },
                        { name: 'Mollie / Payconiq', type: 'Direct', description: 'European payment service providers', marketShare: '10-12%', strength: 'Moderate' },
                        { name: 'Worldline', type: 'Direct', description: 'European leader in payment services', marketShare: '15-18%', strength: 'Strong' }
                    );
                } else if (countryLower.includes('singapore') || countryLower.includes('malaysia') || 
                          countryLower.includes('thailand') || countryLower.includes('indonesia')) {
                    competitors.push(
                        { name: 'Grab Financial / GrabPay', type: 'Direct', description: 'Super-app payment solution across SEA', marketShare: '25-30%', strength: 'Strong' },
                        { name: 'Stripe (SEA)', type: 'Direct', description: 'Expanding presence in Southeast Asia', marketShare: '15-20%', strength: 'Strong' },
                        { name: countryLower.includes('singapore') ? '2C2P' : 'iPay88', type: 'Direct', 
                          description: 'Regional payment gateway provider', marketShare: '15-18%', strength: 'Moderate' },
                        { name: countryLower.includes('indonesia') ? 'Xendit / Midtrans' : 'Omise', type: 'Direct', 
                          description: 'Local payment gateway solutions', marketShare: '12-15%', strength: 'Moderate' }
                    );
                } else if (countryLower.includes('japan')) {
                    competitors.push(
                        { name: 'PayPay', type: 'Direct', description: 'Leading mobile payment app in Japan', marketShare: '35-40%', strength: 'Strong' },
                        { name: 'LINE Pay', type: 'Direct', description: 'Payment service within LINE messaging app', marketShare: '15-18%', strength: 'Moderate' },
                        { name: 'Rakuten Pay', type: 'Direct', description: 'E-commerce giant\'s payment solution', marketShare: '12-15%', strength: 'Moderate' },
                        { name: 'GMO Payment Gateway', type: 'Direct', description: 'Major payment gateway provider in Japan', marketShare: '15-20%', strength: 'Strong' }
                    );
                } else if (countryLower.includes('africa') || countryLower.includes('kenya') || 
                          countryLower.includes('nigeria')) {
                    competitors.push(
                        { name: 'M-Pesa (Vodafone)', type: 'Direct', description: 'Mobile money platform dominant in East Africa', marketShare: '40-45%', strength: 'Strong' },
                        { name: countryLower.includes('nigeria') ? 'Flutterwave' : 'Paystack', type: 'Direct', 
                          description: 'Leading African payment gateway', marketShare: '20-25%', strength: 'Strong' },
                        { name: 'Interswitch', type: 'Direct', description: 'Major payment processing in Nigeria/Africa', marketShare: '15-18%', strength: 'Strong' },
                        { name: 'OPay / PalmPay', type: 'Direct', description: 'Mobile payment platforms in Africa', marketShare: '10-12%', strength: 'Moderate' }
                    );
                } else {
                    // Default to US/North America competitors - EXPANDED
                    competitors.push(
                        { name: 'Stripe', type: 'Direct', description: 'Leading online payment processor with developer-friendly APIs', marketShare: '20-23%', strength: 'Strong' },
                        { name: 'PayPal', type: 'Direct', description: 'Digital payment platform with global reach', marketShare: '16-18%', strength: 'Strong' },
                        { name: 'Square (Block)', type: 'Direct', description: 'POS and payment solutions for small businesses', marketShare: '12-15%', strength: 'Strong' },
                        { name: 'Braintree (PayPal)', type: 'Direct', description: 'Payment gateway for online businesses', marketShare: '8-10%', strength: 'Strong' },
                        { name: 'Adyen', type: 'Direct', description: 'Global payment platform for enterprises', marketShare: '7-9%', strength: 'Moderate' },
                        { name: 'Authorize.net', type: 'Direct', description: 'Traditional payment gateway', marketShare: '6-8%', strength: 'Moderate' },
                        { name: 'Worldpay (FIS)', type: 'Direct', description: 'Payment processor and merchant services', marketShare: '5-7%', strength: 'Moderate' },
                        { name: 'Checkout.com', type: 'Direct', description: 'Global payment processing platform', marketShare: '3-4%', strength: 'Moderate' },
                        { name: 'Clover (Fiserv)', type: 'Direct', description: 'POS systems and payment processing', marketShare: '3-4%', strength: 'Moderate' },
                        { name: 'PayPal Zettle', type: 'Direct', description: 'Mobile card reader and payment app', marketShare: '2-3%', strength: 'Weak' },
                        { name: 'Apple Pay / Google Pay', type: 'Indirect', description: 'Digital wallet platforms', marketShare: '6-8%', strength: 'Moderate' },
                        { name: 'Venmo (PayPal)', type: 'Indirect', description: 'P2P payment app', marketShare: '2-3%', strength: 'Weak' },
                        { name: 'Zelle', type: 'Indirect', description: 'Bank-backed P2P payment network', marketShare: '3-4%', strength: 'Moderate' }
                    );
                }
            } else if (isFood) {
                // Country-specific food/restaurant competitors
                if (ideaLower.includes('coffee')) {
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Caf√© Coffee Day (CCD)', type: 'Direct', description: 'India\'s largest coffee chain with 1,500+ outlets', marketShare: '28-32%', strength: 'Strong' },
                            { name: 'Starbucks India', type: 'Direct', description: 'Premium international coffee chain (Tata partnership)', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Barista Coffee', type: 'Direct', description: 'Established Indian coffee chain', marketShare: '8-10%', strength: 'Moderate' },
                            { name: 'Costa Coffee India', type: 'Direct', description: 'Coca-Cola owned coffee chain', marketShare: '6-8%', strength: 'Moderate' },
                            { name: 'Chaayos', type: 'Direct', description: 'Tea & coffee cafe chain', marketShare: '4-6%', strength: 'Moderate' },
                            { name: 'Blue Tokai Coffee Roasters', type: 'Direct', description: 'Specialty coffee roaster and cafes', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'Third Wave Coffee', type: 'Direct', description: 'Specialty coffee chain', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'Sleepy Owl Coffee', type: 'Direct', description: 'Cold brew coffee brand with cafes', marketShare: '1-2%', strength: 'Weak' },
                            { name: 'Cafe Madras / Indian Coffee House', type: 'Direct', description: 'Traditional Indian coffee chains', marketShare: '3-5%', strength: 'Moderate' },
                            { name: 'Local Independent Cafes', type: 'Direct', description: 'Thousands of independent coffee shops', marketShare: '25-30%', strength: 'Strong' }
                        );
                    } else if (countryLower.includes('uk') || countryLower.includes('europe')) {
                        competitors.push(
                            { name: 'Costa Coffee', type: 'Direct', description: 'UK\'s largest coffee chain (Coca-Cola owned)', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Starbucks', type: 'Direct', description: 'Global coffee chain with strong European presence', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Caff√® Nero', type: 'Direct', description: 'Italian-style coffee chain', marketShare: '12-15%', strength: 'Moderate' },
                            { name: 'Pret A Manger', type: 'Indirect', description: 'Sandwich shop with coffee offerings', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('australia')) {
                        competitors.push(
                            { name: 'Gloria Jean\'s', type: 'Direct', description: 'Major Australian coffee chain', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Starbucks (limited)', type: 'Direct', description: 'Smaller presence in Australia', marketShare: '5-8%', strength: 'Weak' },
                            { name: 'Independent Cafes', type: 'Direct', description: 'Strong independent coffee culture', marketShare: '60-65%', strength: 'Strong' },
                            { name: 'The Coffee Club', type: 'Direct', description: 'Popular chain across Australia', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Default - EXPANDED coffee competitors
                        competitors.push(
                            { name: 'Starbucks', type: 'Direct', description: 'Global coffee chain with 16,000+ US locations', marketShare: '38-42%', strength: 'Strong' },
                            { name: 'Dunkin\' Donuts', type: 'Direct', description: 'Value-oriented coffee and donut chain', marketShare: '22-25%', strength: 'Strong' },
                            { name: 'Tim Hortons', type: 'Direct', description: 'Canadian chain expanding in US', marketShare: '5-7%', strength: 'Moderate' },
                            { name: 'Peet\'s Coffee', type: 'Direct', description: 'Premium coffee roaster and cafes', marketShare: '3-4%', strength: 'Moderate' },
                            { name: 'Blue Bottle Coffee', type: 'Direct', description: 'Specialty coffee chain (Nestl√© owned)', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'The Coffee Bean & Tea Leaf', type: 'Direct', description: 'Premium coffee and tea chain', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'Caribou Coffee', type: 'Direct', description: 'Coffee chain in midwest/northeast', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'Dutch Bros Coffee', type: 'Direct', description: 'Drive-thru coffee chain', marketShare: '2-3%', strength: 'Moderate' },
                            { name: 'Philz Coffee', type: 'Direct', description: 'Customized coffee experience', marketShare: '1-2%', strength: 'Weak' },
                            { name: 'Einstein Bros. Bagels', type: 'Indirect', description: 'Bagel chain with coffee service', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'Panera Bread', type: 'Indirect', description: 'Bakery-cafe with coffee offerings', marketShare: '3-4%', strength: 'Moderate' },
                            { name: 'Local Independent Cafes', type: 'Direct', description: 'Thousands of specialty coffee shops', marketShare: '12-15%', strength: 'Moderate' }
                        );
                    }
                } else {
                    // General restaurant/food
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Zomato / Swiggy', type: 'Indirect', description: 'Food delivery platforms aggregating restaurants', marketShare: '35-40%', strength: 'Strong' },
                            { name: 'Local Restaurants & Dhabas', type: 'Direct', description: 'Independent eateries dominating the market', marketShare: '40-45%', strength: 'Strong' },
                            { name: 'Jubilant FoodWorks (Domino\'s)', type: 'Direct', description: 'QSR chains like Domino\'s, Dunkin\'', marketShare: '10-12%', strength: 'Moderate' },
                            { name: 'Cloud Kitchens / Rebel Foods', type: 'Direct', description: 'Delivery-only food brands', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('china')) {
                        competitors.push(
                            { name: 'Meituan / Ele.me', type: 'Indirect', description: 'Dominant food delivery platforms', marketShare: '50-55%', strength: 'Strong' },
                            { name: 'KFC / McDonald\'s China', type: 'Direct', description: 'Western QSR chains adapted for China', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Local Chain Restaurants', type: 'Direct', description: 'Regional Chinese restaurant chains', marketShare: '25-30%', strength: 'Moderate' },
                            { name: 'Haidilao / Xiabu Xiabu', type: 'Direct', description: 'Popular hotpot restaurant chains', marketShare: '5-8%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Default
                        competitors.push(
                            { name: 'McDonald\'s', type: 'Direct', description: 'QSR giant with massive scale and efficiency', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'DoorDash / Uber Eats', type: 'Indirect', description: 'Food delivery platforms aggregating restaurants', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'Local Independent Restaurants', type: 'Direct', description: 'Independent eateries with unique offerings', marketShare: '35-40%', strength: 'Moderate' },
                            { name: 'Chipotle / Fast Casual Chains', type: 'Direct', description: 'Fast-casual restaurant segment', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    }
                }
            } else if (isTech) {
                // Country-specific tech competitors
                if (ideaLower.includes('ai') || ideaLower.includes('ml')) {
                    if (countryLower.includes('china')) {
                        competitors.push(
                            { name: 'Baidu AI / Ernie Bot', type: 'Direct', description: 'Chinese AI platform and LLM', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Alibaba Cloud AI', type: 'Direct', description: 'Cloud AI services from Alibaba', marketShare: '25-28%', strength: 'Strong' },
                            { name: 'Tencent AI', type: 'Direct', description: 'AI research and applications', marketShare: '15-18%', strength: 'Moderate' },
                            { name: 'SenseTime / Megvii', type: 'Direct', description: 'Computer vision AI companies', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Global default
                        competitors.push(
                            { name: 'OpenAI', type: 'Direct', description: 'Leading AI company (ChatGPT, GPT-4)', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Anthropic', type: 'Direct', description: 'AI safety-focused company (Claude)', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Google DeepMind', type: 'Direct', description: 'Google\'s AI research division (Gemini)', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Microsoft Azure OpenAI', type: 'Direct', description: 'Enterprise AI through Azure', marketShare: '12-15%', strength: 'Strong' }
                        );
                    }
                } else if (ideaLower.includes('saas') || ideaLower.includes('crm') || ideaLower.includes('software')) {
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Zoho', type: 'Direct', description: 'Indian SaaS suite for businesses', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'Freshworks', type: 'Direct', description: 'Customer engagement SaaS from India', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Salesforce', type: 'Direct', description: 'Global CRM leader with India presence', marketShare: '20-22%', strength: 'Strong' },
                            { name: 'Microsoft Dynamics', type: 'Direct', description: 'Enterprise software suite', marketShare: '12-15%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('europe') || countryLower.includes('germany')) {
                        competitors.push(
                            { name: 'SAP', type: 'Direct', description: 'German enterprise software giant', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Salesforce', type: 'Direct', description: 'CRM leader with strong EU presence', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Microsoft Dynamics', type: 'Direct', description: 'Business applications platform', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Pipedrive / Odoo', type: 'Direct', description: 'European SaaS alternatives', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Default
                        competitors.push(
                            { name: 'Salesforce', type: 'Direct', description: 'CRM and business software leader', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'HubSpot', type: 'Direct', description: 'Inbound marketing and sales platform', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Microsoft 365 / Dynamics', type: 'Direct', description: 'Productivity and business apps', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'ServiceNow / Workday', type: 'Direct', description: 'Enterprise cloud applications', marketShare: '12-15%', strength: 'Strong' }
                        );
                    }
                } else {
                    // Generic tech/software
                    competitors.push(
                        { name: 'AWS / Google Cloud / Azure', type: 'Indirect', description: 'Cloud infrastructure platforms', marketShare: '30-35%', strength: 'Strong' },
                        { name: 'Established Tech Companies', type: 'Direct', description: 'Well-funded competitors with large user bases', marketShare: '25-30%', strength: 'Strong' },
                        { name: 'VC-Backed Startups', type: 'Direct', description: 'Innovative competitors with strong funding', marketShare: '15-20%', strength: 'Moderate' },
                        { name: 'Bootstrap SaaS / Open Source', type: 'Direct', description: 'Lean competitors with product-market fit', marketShare: '10-12%', strength: 'Moderate' }
                    );
                }
            } else if (isRetail) {
                // Country-specific retail competitors
                if (ideaLower.includes('online') || ideaLower.includes('ecommerce')) {
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Amazon India', type: 'Direct', description: 'E-commerce leader in India', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Flipkart (Walmart)', type: 'Direct', description: 'India\'s homegrown e-commerce giant', marketShare: '30-33%', strength: 'Strong' },
                            { name: 'Meesho', type: 'Direct', description: 'Social commerce platform', marketShare: '10-12%', strength: 'Moderate' },
                            { name: 'Myntra / Ajio', type: 'Direct', description: 'Fashion-focused e-commerce', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('china')) {
                        competitors.push(
                            { name: 'Taobao / Tmall (Alibaba)', type: 'Direct', description: 'Dominant e-commerce platforms in China', marketShare: '45-50%', strength: 'Strong' },
                            { name: 'JD.com', type: 'Direct', description: 'Major B2C e-commerce platform', marketShare: '25-28%', strength: 'Strong' },
                            { name: 'Pinduoduo', type: 'Direct', description: 'Social commerce with group buying', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Douyin / Kuaishou', type: 'Indirect', description: 'Live commerce platforms', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('brazil')) {
                        competitors.push(
                            { name: 'Mercado Libre', type: 'Direct', description: 'Latin America\'s largest e-commerce platform', marketShare: '35-40%', strength: 'Strong' },
                            { name: 'Amazon Brazil', type: 'Direct', description: 'Global giant expanding in Brazil', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Magazine Luiza', type: 'Direct', description: 'Brazilian retail chain with strong online presence', marketShare: '12-15%', strength: 'Moderate' },
                            { name: 'Americanas / Shopee', type: 'Direct', description: 'Local e-commerce platforms', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('europe') || countryLower.includes('germany') || countryLower.includes('uk')) {
                        competitors.push(
                            { name: 'Amazon (EU)', type: 'Direct', description: 'Dominant e-commerce across Europe', marketShare: '30-35%', strength: 'Strong' },
                            { name: countryLower.includes('uk') ? 'eBay UK' : 'Otto / Zalando', type: 'Direct', description: countryLower.includes('uk') ? 'Auction and marketplace platform' : 'Major European e-commerce', marketShare: '15-20%', strength: 'Strong' },
                            { name: 'Shopify Stores', type: 'Direct', description: 'Independent merchants on Shopify', marketShare: '15-18%', strength: 'Moderate' },
                            { name: 'ASOS / Boohoo', type: 'Direct', description: 'Fashion e-commerce platforms', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Default
                        competitors.push(
                            { name: 'Amazon', type: 'Direct', description: 'E-commerce giant dominating online retail', marketShare: '38-42%', strength: 'Strong' },
                            { name: 'Shopify Stores', type: 'Direct', description: 'Independent online stores on Shopify', marketShare: '20-25%', strength: 'Moderate' },
                            { name: 'Walmart.com', type: 'Direct', description: 'Walmart\'s growing e-commerce', marketShare: '8-10%', strength: 'Strong' },
                            { name: 'eBay / Etsy', type: 'Direct', description: 'Marketplace platforms', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    }
                } else {
                    // Physical retail
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Reliance Retail', type: 'Direct', description: 'India\'s largest retail chain', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'DMart (Avenue Supermarts)', type: 'Direct', description: 'Value retail chain', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Big Bazaar / Future Group', type: 'Direct', description: 'Hypermarket chain', marketShare: '12-15%', strength: 'Moderate' },
                            { name: 'Local Kirana Stores', type: 'Direct', description: 'Traditional neighborhood stores', marketShare: '35-40%', strength: 'Strong' }
                        );
                    } else if (countryLower.includes('uk')) {
                        competitors.push(
                            { name: 'Tesco', type: 'Direct', description: 'UK\'s largest supermarket chain', marketShare: '27-30%', strength: 'Strong' },
                            { name: 'Sainsbury\'s', type: 'Direct', description: 'Major UK supermarket', marketShare: '15-17%', strength: 'Strong' },
                            { name: 'Asda (Walmart)', type: 'Direct', description: 'Value-focused supermarket', marketShare: '13-15%', strength: 'Moderate' },
                            { name: 'Local Shops / Co-op', type: 'Direct', description: 'Community and convenience stores', marketShare: '20-25%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Default
                        competitors.push(
                            { name: 'Walmart', type: 'Direct', description: 'Big box retailer with massive scale', marketShare: '25-28%', strength: 'Strong' },
                            { name: 'Target', type: 'Direct', description: 'Mid-tier department store chain', marketShare: '12-15%', strength: 'Strong' },
                            { name: 'Costco', type: 'Direct', description: 'Membership warehouse club', marketShare: '10-12%', strength: 'Strong' },
                            { name: 'Local Boutiques / Specialty', type: 'Direct', description: 'Independent stores with curated selection', marketShare: '15-20%', strength: 'Moderate' }
                        );
                    }
                }
            } else if (isService) {
                // Country-specific service competitors
                if (ideaLower.includes('consult')) {
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Tata Consultancy Services (TCS)', type: 'Direct', description: 'India\'s largest IT consultancy', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'Infosys / Wipro', type: 'Direct', description: 'Major Indian consulting firms', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Deloitte / PwC India', type: 'Direct', description: 'Big Four with India operations', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Local Boutique Firms', type: 'Direct', description: 'Specialized consultancies', marketShare: '20-25%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('uk') || countryLower.includes('europe')) {
                        competitors.push(
                            { name: 'McKinsey / BCG / Bain', type: 'Direct', description: 'MBB strategy consulting firms', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Deloitte / PwC / EY / KPMG', type: 'Direct', description: 'Big Four consulting', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Accenture / Capgemini', type: 'Direct', description: 'Technology consulting giants', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Boutique Firms', type: 'Direct', description: 'Industry-specialized consultancies', marketShare: '15-20%', strength: 'Moderate' }
                        );
                    } else {
                        // US/Default
                        competitors.push(
                            { name: 'McKinsey & Company', type: 'Direct', description: 'Top-tier strategy consulting firm', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'BCG / Bain', type: 'Direct', description: 'Elite strategy consultancies', marketShare: '12-15%', strength: 'Strong' },
                            { name: 'Deloitte / PwC / EY / KPMG', type: 'Direct', description: 'Big Four consulting arms', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Boutique / Independent', type: 'Direct', description: 'Specialized firms and solo consultants', marketShare: '25-30%', strength: 'Moderate' }
                        );
                    }
                } else {
                    // General services
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Urban Company', type: 'Indirect', description: 'On-demand service platform in India', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'Local Service Providers', type: 'Direct', description: 'Independent professionals and agencies', marketShare: '40-45%', strength: 'Strong' },
                            { name: 'Upwork / Freelancer', type: 'Indirect', description: 'Global freelance marketplaces', marketShare: '15-18%', strength: 'Moderate' },
                            { name: 'Industry Associations', type: 'Direct', description: 'Professional networks and referrals', marketShare: '8-10%', strength: 'Weak' }
                        );
                    } else {
                        // US/Global default
                        competitors.push(
                            { name: 'Upwork / Fiverr', type: 'Indirect', description: 'Freelance marketplaces connecting service providers', marketShare: '25-30%', strength: 'Moderate' },
                            { name: 'TaskRabbit / Thumbtack', type: 'Indirect', description: 'Local service marketplaces', marketShare: '15-18%', strength: 'Moderate' },
                            { name: 'Established Service Firms', type: 'Direct', description: 'Well-known companies with strong reputations', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Local Independent Providers', type: 'Direct', description: 'Solo practitioners and small agencies', marketShare: '20-25%', strength: 'Moderate' }
                        );
                    }
                }
            } else {
                // Check for specialized sectors
                const isEnergy = ideaLower.includes('gas') || ideaLower.includes('energy') || 
                                ideaLower.includes('oil') || ideaLower.includes('fuel') || 
                                ideaLower.includes('petroleum') || ideaLower.includes('lpg');
                const isHealthcare = ideaLower.includes('health') || ideaLower.includes('medical') || 
                                    ideaLower.includes('clinic') || ideaLower.includes('hospital') ||
                                    ideaLower.includes('pharma');
                const isLogistics = ideaLower.includes('logistics') || ideaLower.includes('delivery') || 
                                   ideaLower.includes('shipping') || ideaLower.includes('transport') ||
                                   ideaLower.includes('courier');
                const isRealEstate = ideaLower.includes('real estate') || ideaLower.includes('property') || 
                                    ideaLower.includes('housing') || ideaLower.includes('rental');
                
                if (isEnergy) {
                    // Energy/Gas sector competitors - EXPANDED to 10+ companies
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Indian Oil Corporation (IOC)', type: 'Direct', description: 'India\'s largest oil & gas PSU, leading LPG distributor', marketShare: '28-32%', strength: 'Strong' },
                            { name: 'Bharat Petroleum (BPCL)', type: 'Direct', description: 'Major PSU in petroleum refining and LPG distribution', marketShare: '18-22%', strength: 'Strong' },
                            { name: 'Hindustan Petroleum (HPCL)', type: 'Direct', description: 'Integrated PSU oil & gas company', marketShare: '14-16%', strength: 'Strong' },
                            { name: 'Reliance Industries (Jio-bp)', type: 'Direct', description: 'Private player in fuel retail and LPG', marketShare: '8-10%', strength: 'Strong' },
                            { name: 'Adani Gas (Adani Total Gas)', type: 'Direct', description: 'City gas distribution across multiple cities', marketShare: '6-8%', strength: 'Moderate' },
                            { name: 'Indraprastha Gas Limited (IGL)', type: 'Direct', description: 'CNG and PNG distributor in Delhi-NCR', marketShare: '5-7%', strength: 'Moderate' },
                            { name: 'Mahanagar Gas Limited (MGL)', type: 'Direct', description: 'Gas distribution in Mumbai region', marketShare: '4-5%', strength: 'Moderate' },
                            { name: 'Gujarat Gas', type: 'Direct', description: 'Natural gas distributor in Gujarat', marketShare: '3-4%', strength: 'Moderate' },
                            { name: 'GAIL (Gas Authority of India)', type: 'Direct', description: 'Natural gas transmission and marketing', marketShare: '4-6%', strength: 'Moderate' },
                            { name: 'Torrent Gas', type: 'Direct', description: 'City gas distribution company', marketShare: '2-3%', strength: 'Weak' },
                            { name: 'Think Gas (Adani)', type: 'Direct', description: 'PNG and CNG distribution', marketShare: '2-3%', strength: 'Weak' }
                        );
                    } else if (countryLower.includes('uk') || countryLower.includes('europe')) {
                        competitors.push(
                            { name: 'British Gas / Centrica', type: 'Direct', description: 'UK\'s largest energy supplier', marketShare: '25-28%', strength: 'Strong' },
                            { name: 'E.ON / EDF Energy', type: 'Direct', description: 'Major European energy companies', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Shell Energy / BP', type: 'Direct', description: 'Oil majors with retail energy', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Octopus Energy / Bulb', type: 'Direct', description: 'New energy suppliers', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('us') || countryLower.includes('united states')) {
                        competitors.push(
                            { name: 'ExxonMobil / Chevron', type: 'Indirect', description: 'Oil & gas supermajors', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'ConocoPhillips / Marathon', type: 'Direct', description: 'Major US energy companies', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Local Utility Companies', type: 'Direct', description: 'Regional gas utilities (varies by state)', marketShare: '40-45%', strength: 'Strong' },
                            { name: 'Amerigas / Ferrellgas', type: 'Direct', description: 'Propane/LPG distributors', marketShare: '10-12%', strength: 'Moderate' }
                        );
                    } else {
                        competitors.push(
                            { name: 'National Oil Companies', type: 'Direct', description: 'State-owned energy companies', marketShare: '35-40%', strength: 'Strong' },
                            { name: 'Shell / BP / Total', type: 'Direct', description: 'International oil majors', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'Local Gas Distributors', type: 'Direct', description: 'Regional suppliers and utilities', marketShare: '20-25%', strength: 'Moderate' },
                            { name: 'Independent Suppliers', type: 'Direct', description: 'Private energy companies', marketShare: '10-15%', strength: 'Moderate' }
                        );
                    }
                } else if (isHealthcare) {
                    // Healthcare sector
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Apollo Hospitals', type: 'Direct', description: 'India\'s largest hospital chain', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Fortis Healthcare', type: 'Direct', description: 'Multi-specialty hospital network', marketShare: '15-18%', strength: 'Strong' },
                            { name: 'Max Healthcare', type: 'Direct', description: 'Premium healthcare provider', marketShare: '12-15%', strength: 'Moderate' },
                            { name: 'Local Clinics', type: 'Direct', description: 'Independent healthcare providers', marketShare: '40-45%', strength: 'Strong' }
                        );
                    } else {
                        competitors.push(
                            { name: 'Major Hospital Chains', type: 'Direct', description: 'Multi-location healthcare providers', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'National Health Systems', type: 'Indirect', description: 'Public healthcare providers', marketShare: '30-40%', strength: 'Strong' },
                            { name: 'Independent Clinics', type: 'Direct', description: 'Local practices', marketShare: '25-30%', strength: 'Moderate' }
                        );
                    }
                } else if (isLogistics) {
                    // Logistics sector
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Delhivery', type: 'Direct', description: 'India\'s largest logistics company', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'Blue Dart (DHL)', type: 'Direct', description: 'Premium courier service', marketShare: '20-22%', strength: 'Strong' },
                            { name: 'Ecom Express', type: 'Direct', description: 'E-commerce logistics', marketShare: '18-20%', strength: 'Strong' },
                            { name: 'India Post', type: 'Indirect', description: 'Government postal service', marketShare: '15-18%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('us')) {
                        competitors.push(
                            { name: 'UPS', type: 'Direct', description: 'Package delivery giant', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'FedEx', type: 'Direct', description: 'Express shipping leader', marketShare: '25-28%', strength: 'Strong' },
                            { name: 'Amazon Logistics', type: 'Direct', description: 'Amazon delivery network', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'USPS', type: 'Indirect', description: 'Postal service', marketShare: '15-18%', strength: 'Moderate' }
                        );
                    } else {
                        competitors.push(
                            { name: 'DHL / FedEx', type: 'Direct', description: 'International logistics', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Local Couriers', type: 'Direct', description: 'Regional delivery companies', marketShare: '35-40%', strength: 'Strong' },
                            { name: 'National Post', type: 'Indirect', description: 'Postal operators', marketShare: '20-25%', strength: 'Moderate' }
                        );
                    }
                } else if (isRealEstate) {
                    // Real Estate sector
                    if (countryLower.includes('india')) {
                        competitors.push(
                            { name: 'Housing.com / 99acres', type: 'Indirect', description: 'Property listing platforms', marketShare: '25-30%', strength: 'Strong' },
                            { name: 'DLF / Godrej Properties', type: 'Direct', description: 'Major developers', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Local Agents', type: 'Direct', description: 'Independent brokers', marketShare: '40-45%', strength: 'Strong' },
                            { name: 'NoBroker', type: 'Direct', description: 'PropTech startups', marketShare: '8-10%', strength: 'Moderate' }
                        );
                    } else if (countryLower.includes('us')) {
                        competitors.push(
                            { name: 'Zillow / Redfin', type: 'Indirect', description: 'Online real estate marketplaces', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Realtor.com', type: 'Indirect', description: 'MLS listing aggregator', marketShare: '20-25%', strength: 'Strong' },
                            { name: 'Keller Williams / RE/MAX', type: 'Direct', description: 'Real estate franchises', marketShare: '25-28%', strength: 'Strong' },
                            { name: 'Independent Agents', type: 'Direct', description: 'Local professionals', marketShare: '15-20%', strength: 'Moderate' }
                        );
                    } else {
                        competitors.push(
                            { name: 'Online Property Portals', type: 'Indirect', description: 'Digital platforms', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Major Agencies', type: 'Direct', description: 'Established firms', marketShare: '30-35%', strength: 'Strong' },
                            { name: 'Independent Agents', type: 'Direct', description: 'Local brokers', marketShare: '30-35%', strength: 'Moderate' }
                        );
                    }
                } else {
                    // Generic fallback
                    competitors.push(
                        { name: 'Industry Market Leader', type: 'Direct', description: 'Dominant player with significant brand recognition', marketShare: '25-35%', strength: 'Strong' },
                        { name: 'Established Competitors', type: 'Direct', description: 'Well-funded players with solid market presence', marketShare: '20-25%', strength: 'Moderate' },
                        { name: 'Regional Players', type: 'Direct', description: 'Local/regional competitors with loyal customers', marketShare: '15-20%', strength: 'Moderate' },
                        { name: 'Niche Specialists', type: 'Direct', description: 'Focused competitors serving specific segments', marketShare: '10-15%', strength: 'Moderate' }
                    );
                }
            }
            
            return competitors;
        }

        function generateDifferentiation(idea, isFood, isTech, isRetail, isService) {
            const strategies = [];
            
            if (isFood) {
                strategies.push(
                    'Focus on locally-sourced, organic ingredients with transparent supply chain',
                    'Create unique ambiance and community space (co-working, events, local art)',
                    'Develop signature products or flavors not available from chains',
                    'Implement sustainability practices (zero waste, compostable packaging, carbon neutral)',
                    'Build strong local partnerships and support community causes'
                );
            } else if (isTech) {
                strategies.push(
                    'Solve a specific pain point better than generic solutions (niche focus)',
                    'Offer superior user experience with simpler, more intuitive interface',
                    'Provide exceptional customer support and onboarding',
                    'Build for a specific industry vertical with tailored features',
                    'Compete on pricing with more transparent, flexible plans'
                );
            } else if (isRetail) {
                strategies.push(
                    'Curate unique product selection not available in mass market',
                    'Provide personalized customer service and shopping experience',
                    'Build strong brand story and values-driven positioning',
                    'Offer omnichannel experience (seamless online and offline)',
                    'Create loyalty program and community around the brand'
                );
            } else if (isService) {
                strategies.push(
                    'Specialize in a specific industry or problem type',
                    'Deliver faster turnaround times with more responsive service',
                    'Offer unique methodology or framework',
                    'Provide transparent pricing and clear deliverables',
                    'Build thought leadership through content and education'
                );
            } else {
                strategies.push(
                    'Differentiate on quality and attention to detail',
                    'Build strong brand and unique positioning',
                    'Provide exceptional customer experience',
                    'Innovate on business model or service delivery',
                    'Focus on underserved market segment or niche'
                );
            }
            
            return strategies;
        }

        function generateResources(idea, country, isFood, isTech, isRetail, isService) {
            const resources = {
                technology: [],
                physical: [],
                human: [],
                marketing: [],
                legal: []
            };
            
            // Technology & Software
            if (isTech) {
                resources.technology = [
                    { name: 'Cloud Infrastructure (AWS/GCP)', purpose: 'Hosting and scalability', cost: '$200-500/mo' },
                    { name: 'Development Tools & IDEs', purpose: 'Code development environment', cost: '$100-300/mo' },
                    { name: 'Analytics & Monitoring', purpose: 'Track performance and usage', cost: '$100-400/mo' },
                    { name: 'Customer Support Platform', purpose: 'Help desk and ticketing', cost: '$50-200/mo' },
                    { name: 'Payment Processing', purpose: 'Accept customer payments', cost: '2.9% + $0.30/txn' },
                    { name: 'Marketing Automation', purpose: 'Email and campaign management', cost: '$50-300/mo' }
                ];
            } else {
                resources.technology = [
                    { name: 'POS System', purpose: 'Sales transactions and inventory', cost: '$50-150/mo' },
                    { name: 'Website & E-commerce', purpose: 'Online presence and sales', cost: '$30-100/mo' },
                    { name: 'Accounting Software', purpose: 'Financial management', cost: '$30-70/mo' },
                    { name: 'Social Media Tools', purpose: 'Content scheduling and analytics', cost: '$20-100/mo' },
                    { name: 'CRM System', purpose: 'Customer relationship management', cost: '$25-100/mo' },
                    { name: 'Email Marketing', purpose: 'Customer communications', cost: '$20-80/mo' }
                ];
            }
            
            // Physical Resources
            if (isFood || isRetail) {
                resources.physical = [
                    { name: 'Retail/Cafe Space', purpose: 'Physical location (500-1500 sq ft)', cost: '$2k-5k/mo' },
                    { name: 'Equipment & Fixtures', purpose: isFood ? 'Coffee machines, refrigeration' : 'Display fixtures, furniture', cost: '$15k-40k' },
                    { name: 'Initial Inventory', purpose: 'Starting stock and supplies', cost: '$5k-20k' },
                    { name: 'Signage & Decor', purpose: 'Branding and ambiance', cost: '$3k-10k' },
                    { name: 'Storage & Back Office', purpose: 'Inventory and operations space', cost: 'Included' },
                    { name: 'Security System', purpose: 'Surveillance and protection', cost: '$1k-3k' }
                ];
            } else if (isTech) {
                resources.physical = [
                    { name: 'Office Space (Optional)', purpose: 'Team workspace if not remote', cost: '$500-2k/mo' },
                    { name: 'Computers & Laptops', purpose: 'Development workstations', cost: '$2k-4k each' },
                    { name: 'Monitors & Peripherals', purpose: 'Additional equipment', cost: '$500-1k' },
                    { name: 'Server/Testing Equipment', purpose: 'Development and testing', cost: '$2k-5k' }
                ];
            } else {
                resources.physical = [
                    { name: 'Office/Meeting Space', purpose: 'Client meetings and work', cost: '$500-2k/mo' },
                    { name: 'Office Furniture', purpose: 'Desks, chairs, conference table', cost: '$2k-5k' },
                    { name: 'Computers & Equipment', purpose: 'Work devices', cost: '$2k-4k' },
                    { name: 'Professional Materials', purpose: 'Industry-specific tools', cost: '$1k-5k' }
                ];
            }
            
            // Human Resources
            if (isFood || isRetail) {
                resources.human = [
                    { role: 'You (Founder/Manager)', description: 'Overall operations, strategy, finances', timing: 'Day 1' },
                    { role: 'Staff (2-3 part-time)', description: 'Customer service, operations support', timing: 'Month 1-3' },
                    { role: 'Marketing Specialist', description: 'Social media, promotions (contract/part-time)', timing: 'Month 3-6' },
                    { role: 'Additional Staff', description: 'Scale team as revenue grows', timing: 'Month 6-12' }
                ];
            } else if (isTech) {
                resources.human = [
                    { role: 'Technical Co-founder/Lead Dev', description: 'Product development and architecture', timing: 'Day 1' },
                    { role: 'Additional Developer(s)', description: 'Feature development, maintenance', timing: 'Month 3-6' },
                    { role: 'Designer (UX/UI)', description: 'User interface and experience', timing: 'Month 1-6' },
                    { role: 'Sales/Customer Success', description: 'User acquisition and retention', timing: 'Month 6-12' }
                ];
            } else {
                resources.human = [
                    { role: 'You (Lead Consultant)', description: 'Client delivery and business development', timing: 'Day 1' },
                    { role: 'Virtual Assistant', description: 'Admin support, scheduling', timing: 'Month 3-6' },
                    { role: 'Junior Consultant', description: 'Delivery support as volume grows', timing: 'Month 6-12' },
                    { role: 'Sales/BD Support', description: 'Lead generation and outreach', timing: 'Year 2' }
                ];
            }
            
            // Marketing Channels
            resources.marketing = [
                { name: 'Social Media Advertising', purpose: 'Facebook, Instagram, LinkedIn ads', cost: '$500-2k/mo' },
                { name: 'Google Ads / SEO', purpose: 'Search visibility and traffic', cost: '$300-1.5k/mo' },
                { name: 'Content Marketing', purpose: 'Blog, videos, educational content', cost: '$200-800/mo' },
                { name: 'Local Partnerships', purpose: 'Cross-promotions and referrals', cost: 'Minimal' },
                { name: 'Email Marketing', purpose: 'Customer retention and promotions', cost: '$50-200/mo' },
                { name: 'Events/Sponsorships', purpose: 'Brand awareness and networking', cost: '$500-2k/quarter' }
            ];
            
            // Legal & Compliance
            resources.legal = [
                { requirement: 'Business Registration', details: `LLC or Corporation formation in ${country}`, priority: 'Critical' },
                { requirement: 'Business Licenses', details: isFood ? 'Food service permits, health inspections' : 'General business license', priority: 'Critical' },
                { requirement: 'Insurance', details: 'Liability, property, and business insurance', priority: 'Critical' },
                { requirement: 'Tax Registration', details: 'Sales tax, employer ID, tax accounts', priority: 'Critical' },
                { requirement: 'Contracts & Agreements', details: 'Customer agreements, vendor contracts', priority: 'Important' },
                { requirement: 'Trademark/IP Protection', details: 'Protect brand name and assets', priority: 'Important' },
                { requirement: 'Data Privacy Compliance', details: isTech ? 'GDPR, CCPA compliance' : 'Customer data protection', priority: isTech ? 'Critical' : 'Important' }
            ];
            
            return resources;
        }

        function generatePaymentPartnership(country) {
            const countryLower = country.toLowerCase();
            
            // Determine payment providers based on country
            let providers = [];
            
            if (countryLower.includes('india')) {
                providers = [
                    {
                        name: 'Razorpay',
                        description: 'Leading payment gateway in India with comprehensive features',
                        fee: '2% + GST (standard), Custom for high volume',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'Paytm Payment Gateway',
                        description: 'Integrated with Paytm wallet, wide merchant acceptance',
                        fee: '1.99% + GST',
                        setupTime: '2-3 weeks'
                    },
                    {
                        name: 'PhonePe Switch / PayU',
                        description: 'UPI-focused payment solutions with competitive rates',
                        fee: '1.8% - 2.2% + GST',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'CCAvenue / Instamojo',
                        description: 'Established payment gateways for Indian SMBs',
                        fee: '2% - 2.5% + GST',
                        setupTime: '1 week'
                    }
                ];
            } else if (countryLower.includes('china')) {
                providers = [
                    {
                        name: 'Alipay (Ant Group)',
                        description: 'Dominant payment platform with 1B+ users',
                        fee: '0.6% - 1.2% (varies by industry)',
                        setupTime: '4-6 weeks'
                    },
                    {
                        name: 'WeChat Pay',
                        description: 'Integrated payment in WeChat ecosystem',
                        fee: '0.6% - 1% (varies)',
                        setupTime: '4-6 weeks'
                    },
                    {
                        name: 'UnionPay',
                        description: 'China\'s national card payment network',
                        fee: '1% - 1.5%',
                        setupTime: '3-4 weeks'
                    }
                ];
            } else if (countryLower.includes('brazil')) {
                providers = [
                    {
                        name: 'Pix Integration',
                        description: 'Brazil\'s instant payment system (free for consumers)',
                        fee: 'Varies by bank, typically R$0.01 - R$0.50/transaction',
                        setupTime: '2-3 weeks'
                    },
                    {
                        name: 'Mercado Pago',
                        description: 'Full-service payment platform with installment options',
                        fee: '3.99% - 5.99% + R$0.40',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'PagSeguro',
                        description: 'Digital payment and POS solutions',
                        fee: '3.49% - 4.99% + R$0.40',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'Stripe Brazil',
                        description: 'International platform expanding in Brazil',
                        fee: '3.99% + R$0.40',
                        setupTime: '2-3 weeks'
                    }
                ];
            } else if (countryLower.includes('uk') || countryLower.includes('united kingdom')) {
                providers = [
                    {
                        name: 'Stripe UK',
                        description: 'Leading online payment processor',
                        fee: '1.5% + ¬£0.20 (UK cards), 2.5% + ¬£0.20 (non-UK)',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'Worldpay (FIS)',
                        description: 'Major UK payment processor',
                        fee: 'Custom pricing, typically 1.2% - 2.5%',
                        setupTime: '2-4 weeks'
                    },
                    {
                        name: 'Adyen',
                        description: 'Unified commerce platform',
                        fee: 'Interchange++ (0.60% - 0.80%)',
                        setupTime: '2-3 weeks'
                    },
                    {
                        name: 'SumUp / Zettle',
                        description: 'SMB-focused payment solutions',
                        fee: '1.69% (card reader), 2.5% (online)',
                        setupTime: '1 week'
                    }
                ];
            } else if (countryLower.includes('germany') || countryLower.includes('france') || 
                       countryLower.includes('europe') || countryLower.includes('eu')) {
                providers = [
                    {
                        name: 'Adyen',
                        description: 'European payment leader with unified platform',
                        fee: 'Interchange++ (0.60% - 0.80% + scheme fees)',
                        setupTime: '2-3 weeks'
                    },
                    {
                        name: 'Stripe Europe',
                        description: 'Developer-friendly with strong EU support',
                        fee: '1.5% + ‚Ç¨0.25 (EU cards), 2.9% + ‚Ç¨0.25 (non-EU)',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'Mollie',
                        description: 'Popular European payment service provider',
                        fee: '0.29‚Ç¨ + 0.25% (iDEAL), varies by method',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'Worldline',
                        description: 'European leader in payment services',
                        fee: 'Custom pricing based on volume',
                        setupTime: '3-4 weeks'
                    }
                ];
            } else if (countryLower.includes('singapore') || countryLower.includes('malaysia') ||
                       countryLower.includes('thailand') || countryLower.includes('indonesia')) {
                const singaporeProviders = [
                    { name: '2C2P', desc: 'Regional payment gateway leader', fee: '2.8% - 3.5%' },
                    { name: 'Stripe Southeast Asia', desc: 'Expanding in SEA markets', fee: '2.9% + SGD 0.50' },
                    { name: 'PayPal (SEA)', desc: 'International payment option', fee: '3.4% + SGD 0.50' }
                ];
                const indonesiaProviders = [
                    { name: 'Xendit', desc: 'Leading Indonesian payment gateway', fee: '2.9% + IDR 2,000' },
                    { name: 'Midtrans (Gojek)', desc: 'Payment solution from Gojek', fee: '2% - 3%' },
                    { name: 'Doku', desc: 'Established payment gateway', fee: '2.5% - 3.5%' }
                ];
                
                const localProviders = countryLower.includes('indonesia') ? indonesiaProviders : singaporeProviders;
                providers = localProviders.map((p, i) => ({
                    name: p.name,
                    description: p.desc,
                    fee: p.fee,
                    setupTime: i === 0 ? '1-2 weeks' : '2-3 weeks'
                }));
            } else if (countryLower.includes('japan')) {
                providers = [
                    {
                        name: 'GMO Payment Gateway',
                        description: 'Leading payment gateway in Japan',
                        fee: '3.25% - 3.65%',
                        setupTime: '2-3 weeks'
                    },
                    {
                        name: 'PayPay for Business',
                        description: 'QR code payment integration',
                        fee: '1.98% (regular), 1.60% (PayPay exclusive)',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'Stripe Japan',
                        description: 'International platform with Japan support',
                        fee: '3.6%',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'SoftBank Payment Service',
                        description: 'Comprehensive payment solutions',
                        fee: 'Custom pricing',
                        setupTime: '3-4 weeks'
                    }
                ];
            } else if (countryLower.includes('africa') || countryLower.includes('kenya') || 
                       countryLower.includes('nigeria') || countryLower.includes('south africa')) {
                const nigerianProviders = [
                    { name: 'Flutterwave', fee: '1.4% + ‚Ç¶0.20 (local cards)', desc: 'Pan-African payment gateway' },
                    { name: 'Paystack', fee: '1.5% + ‚Ç¶100', desc: 'Stripe-backed Nigerian gateway' },
                    { name: 'Interswitch', fee: 'Custom pricing', desc: 'Major payment processor in Nigeria' }
                ];
                const kenyanProviders = [
                    { name: 'M-Pesa Integration', fee: 'B2C: KSh 0.30 - 30 per transaction', desc: 'Mobile money platform' },
                    { name: 'Flutterwave', fee: '1.4% + KSh 20', desc: 'Pan-African payment gateway' },
                    { name: 'Pesapal', fee: '2% - 3.5%', desc: 'East African payment gateway' }
                ];
                
                const localProviders = countryLower.includes('nigeria') ? nigerianProviders : kenyanProviders;
                providers = localProviders.map(p => ({
                    name: p.name,
                    description: p.desc,
                    fee: p.fee,
                    setupTime: '1-3 weeks'
                }));
            } else {
                // Default to US/North America
                providers = [
                    {
                        name: 'Stripe',
                        description: 'Industry-leading payment API with global coverage',
                        fee: '2.9% + $0.30 per transaction',
                        setupTime: '1-2 weeks'
                    },
                    {
                        name: 'PayPal / Braintree',
                        description: 'Trusted payment processor with buyer protection',
                        fee: '2.9% + $0.30 (PayPal), 2.59% + $0.49 (Braintree)',
                        setupTime: '1-3 weeks'
                    },
                    {
                        name: 'Square',
                        description: 'All-in-one payment solution for businesses',
                        fee: '2.6% + $0.10 per transaction',
                        setupTime: '1 week'
                    },
                    {
                        name: 'Authorize.net',
                        description: 'Established payment gateway',
                        fee: '2.9% + $0.30 + $25/month',
                        setupTime: '1-2 weeks'
                    }
                ];
            }
            
            // Country-specific compliance requirements
            let complianceReqs = [
                {
                    requirement: 'Business Registration',
                    details: `Valid business entity registered in ${country} with tax ID/EIN`,
                    priority: 'Critical'
                },
                {
                    requirement: 'KYC Documentation',
                    details: 'Business verification documents, beneficial ownership info, bank statements',
                    priority: 'Critical'
                },
                {
                    requirement: 'AML/CFT Compliance',
                    details: 'Anti-Money Laundering and Counter-Financing of Terrorism policies',
                    priority: 'Critical'
                }
            ];
            
            // Add country-specific data privacy compliance
            if (countryLower.includes('india')) {
                complianceReqs.push({
                    requirement: 'RBI Compliance & Data Localization',
                    details: 'Reserve Bank of India guidelines for payment aggregators, mandatory data storage in India',
                    priority: 'Critical'
                });
                complianceReqs.push({
                    requirement: 'Payment Aggregator License (PA-CB)',
                    details: 'RBI authorization required for payment aggregation (if transaction volume >50 lakhs/year)',
                    priority: 'Critical'
                });
            } else if (countryLower.includes('eu') || countryLower.includes('europe') || 
                       countryLower.includes('uk') || countryLower.includes('germany') || 
                       countryLower.includes('france')) {
                complianceReqs.push({
                    requirement: 'GDPR Compliance',
                    details: 'General Data Protection Regulation for EU customer data protection',
                    priority: 'Critical'
                });
                complianceReqs.push({
                    requirement: 'PSD2 Compliance',
                    details: 'Payment Services Directive 2 - Strong Customer Authentication (SCA) required',
                    priority: 'Critical'
                });
                if (!countryLower.includes('uk')) {
                    complianceReqs.push({
                        requirement: 'E-Money or Payment Institution License',
                        details: 'EU licensing required depending on services offered and transaction volume',
                        priority: 'Critical'
                    });
                }
            } else if (countryLower.includes('china')) {
                complianceReqs.push({
                    requirement: 'PBOC Payment License',
                    details: 'People\'s Bank of China license required for payment services',
                    priority: 'Critical'
                });
                complianceReqs.push({
                    requirement: 'China Data Protection Laws',
                    details: 'Personal Information Protection Law (PIPL) compliance for data handling',
                    priority: 'Critical'
                });
            } else if (countryLower.includes('brazil')) {
                complianceReqs.push({
                    requirement: 'LGPD Compliance',
                    details: 'Lei Geral de Prote√ß√£o de Dados - Brazil\'s data protection law',
                    priority: 'Critical'
                });
                complianceReqs.push({
                    requirement: 'Central Bank Authorization',
                    details: 'Banco Central do Brasil registration for payment institutions',
                    priority: 'Critical'
                });
            } else {
                // US and other countries
                complianceReqs.push({
                    requirement: 'Data Privacy Compliance',
                    details: countryLower.includes('california') ? 
                        'CCPA (California Consumer Privacy Act) compliance required' :
                        'State-specific data protection regulations (varies by region)',
                    priority: 'Important'
                });
                if (countryLower.includes('us') || countryLower.includes('united states') || 
                    countryLower.includes('america')) {
                    complianceReqs.push({
                        requirement: 'Money Transmitter Licenses',
                        details: 'State-by-state MTL licenses required (varies by state, can take 6-18 months)',
                        priority: 'Critical'
                    });
                }
            }
            
            // Common compliance items
            complianceReqs.push(
                {
                    requirement: 'Terms of Service & Privacy Policy',
                    details: 'Clear customer-facing legal documents covering payment terms and data usage',
                    priority: 'Important'
                },
                {
                    requirement: 'Dispute Resolution Process',
                    details: 'Chargeback handling procedures and customer dispute management',
                    priority: 'Important'
                }
            );

            return {
                providers: providers,
                technicalReqs: [
                    {
                        requirement: 'API Integration',
                        details: 'RESTful API integration with webhooks for payment notifications and status updates'
                    },
                    {
                        requirement: 'PCI DSS Compliance',
                        details: 'Payment Card Industry Data Security Standard certification (Level 1 or 2 depending on volume)'
                    },
                    {
                        requirement: 'Secure Hosting',
                        details: 'SSL/TLS encryption, secure server infrastructure with regular security audits'
                    },
                    {
                        requirement: 'Testing Environment',
                        details: 'Sandbox/test mode for development and testing before going live'
                    },
                    {
                        requirement: 'Error Handling & Logging',
                        details: 'Robust error handling, transaction logging, and monitoring systems'
                    }
                ],
                complianceReqs: complianceReqs,
                financialReqs: [
                    {
                        requirement: 'Business Bank Account',
                        details: `Merchant account in ${country} for settlement of funds`
                    },
                    {
                        requirement: 'Reserve Requirements',
                        details: 'Some providers require holding 5-10% of transaction volume as reserve'
                    },
                    {
                        requirement: 'Minimum Transaction Volume',
                        details: countryLower.includes('india') ? 
                            'Some partners require minimum monthly volume (‚Çπ5L-‚Çπ10L+)' :
                            countryLower.includes('brazil') ?
                            'Some partners require minimum monthly volume (R$20k-R$50k+)' :
                            'Some partners require minimum monthly volume ($5k-$10k+)'
                    },
                    {
                        requirement: 'Credit Check',
                        details: 'Business credit check and risk assessment by payment provider'
                    },
                    {
                        requirement: 'Insurance',
                        details: 'Cyber liability insurance and errors & omissions coverage recommended'
                    },
                    {
                        requirement: 'Settlement Period',
                        details: countryLower.includes('india') ? 
                            'Typical payout: T+1 to T+3 days (UPI/IMPS), T+3 to T+7 (cards)' :
                            'Typical payout: T+2 to T+7 days (varies by provider and risk profile)'
                    }
                ]
            };
        }

        function generateMarketGrowthData(marketSize, growthRate) {
            // Extract growth rate percentage
            const growthMatch = growthRate.match(/(\d+)/);
            const growth = growthMatch ? parseInt(growthMatch[0]) / 100 : 0.08;
            
            const baseSize = parseFloat(marketSize);
            const years = ['2024', '2025', '2026', '2027', '2028', '2029'];
            const values = [];
            
            for (let i = 0; i < years.length; i++) {
                values.push((baseSize * Math.pow(1 + growth, i)).toFixed(1));
            }
            
            return {
                labels: years,
                values: values
            };
        }

        function parseAnalysis(text) {
            const sections = {
                score: 50,
                scoreReasoning: 'Analysis based on AI evaluation',
                marketAnalysis: '',
                revenueAnalysis: '',
                competitionAnalysis: '',
                examplesAnalysis: '',
                startupGuide: '',
                riskFactors: ''
            };

            // Extract score
            const scoreMatch = text.match(/SCORE:\s*(\d+)/i);
            if (scoreMatch) {
                sections.score = parseInt(scoreMatch[1]);
            }

            // Extract score reasoning
            const reasoningMatch = text.match(/SCORE_REASONING:\s*(.+?)(?=\n\n|\n[A-Z_]+:)/s);
            if (reasoningMatch) {
                sections.scoreReasoning = reasoningMatch[1].trim();
            }

            // Extract other sections with flexible matching
            const marketMatch = text.match(/MARKET_ANALYSIS:?\s*(.+?)(?=\n\n[A-Z_]+:|$)/s);
            if (marketMatch) sections.marketAnalysis = marketMatch[1].trim();

            const revenueMatch = text.match(/REVENUE_POTENTIAL:?\s*(.+?)(?=\n\n[A-Z_]+:|$)/s);
            if (revenueMatch) sections.revenueAnalysis = revenueMatch[1].trim();

            const competitionMatch = text.match(/COMPETITION:?\s*(.+?)(?=\n\n[A-Z_]+:|$)/s);
            if (competitionMatch) sections.competitionAnalysis = competitionMatch[1].trim();

            const examplesMatch = text.match(/EXAMPLES:?\s*(.+?)(?=\n\n[A-Z_]+:|$)/s);
            if (examplesMatch) sections.examplesAnalysis = examplesMatch[1].trim();

            const startupMatch = text.match(/STARTUP_GUIDE:?\s*(.+?)(?=\n\n[A-Z_]+:|$)/s);
            if (startupMatch) sections.startupGuide = startupMatch[1].trim();

            const risksMatch = text.match(/RISKS:?\s*(.+?)$/s);
            if (risksMatch) sections.riskFactors = risksMatch[1].trim();

            return sections;
        }

        function displayResults(analysis) {
            results.classList.remove('hidden');

            // Animate score circle
            const scoreValue = document.getElementById('scoreValue');
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreInterpretation = document.getElementById('scoreInterpretation');
            
            const score = Math.min(100, Math.max(0, analysis.score));
            const circumference = 552.92;
            const offset = circumference - (score / 100) * circumference;
            
            scoreValue.textContent = score;
            scoreCircle.style.strokeDashoffset = offset;
            
            // Color coding
            if (score >= 70) {
                scoreCircle.style.stroke = '#10b981';
                scoreInterpretation.innerHTML = `<span class="text-green-600">‚úì High Success Probability</span><br><span class="text-sm mt-2 block">${analysis.scoreReasoning}</span>`;
            } else if (score >= 50) {
                scoreCircle.style.stroke = '#f59e0b';
                scoreInterpretation.innerHTML = `<span class="text-amber-600">‚ö† Moderate Success Probability</span><br><span class="text-sm mt-2 block">${analysis.scoreReasoning}</span>`;
            } else {
                scoreCircle.style.stroke = '#ef4444';
                scoreInterpretation.innerHTML = `<span class="text-red-600">‚ö† Low Success Probability</span><br><span class="text-sm mt-2 block">${analysis.scoreReasoning}</span>`;
            }

            // Populate market metrics
            document.getElementById('marketSize').textContent = analysis.metrics.marketSize;
            document.getElementById('growthRate').textContent = analysis.metrics.growthRate;
            document.getElementById('targetShare').textContent = analysis.metrics.targetShare;

            // Create market growth chart
            createMarketGrowthChart(analysis.metrics.marketGrowthData);

            // Populate startup costs
            const startupCostsEl = document.getElementById('startupCosts');
            startupCostsEl.innerHTML = analysis.metrics.startupCosts.map(item => `
                <div class="flex justify-between items-center p-3 bg-gray-100 rounded">
                    <span class="text-sm text-gray-700">${item.category}</span>
                    <span class="font-semibold text-gray-900">${item.amount}</span>
                </div>
            `).join('');
            document.getElementById('totalStartup').textContent = analysis.metrics.totalStartup;

            // Create startup costs pie chart
            createStartupCostsChart(analysis.metrics.startupCosts);

            // Create revenue projection chart
            createRevenueChart(analysis.metrics.revenueProjections);

            // Populate revenue table
            const revenueTable = document.getElementById('revenueTable');
            revenueTable.innerHTML = analysis.metrics.revenueProjections.map(row => `
                <tr class="border-b border-gray-100">
                    <td class="px-4 py-3 font-medium text-gray-700">${row.period}</td>
                    <td class="px-4 py-3 text-right text-green-700">${row.revenue}</td>
                    <td class="px-4 py-3 text-right text-red-700">${row.expenses}</td>
                    <td class="px-4 py-3 text-right font-semibold ${row.netProfit.startsWith('-') ? 'text-red-600' : 'text-green-600'}">${row.netProfit}</td>
                    <td class="px-4 py-3 text-right text-gray-700">${row.margin}</td>
                </tr>
            `).join('');

            // Populate financial metrics
            document.getElementById('breakEven').textContent = analysis.metrics.breakEven;
            document.getElementById('year3Revenue').textContent = analysis.metrics.year3Revenue;
            document.getElementById('roi').textContent = analysis.metrics.roi;

            // Populate competition metrics
            document.getElementById('competitorCount').textContent = analysis.metrics.competitorCount;
            document.getElementById('marketSaturation').textContent = analysis.metrics.marketSaturation;
            document.getElementById('entryBarrier').textContent = analysis.metrics.entryBarrier;
            document.getElementById('competitiveAdvantage').textContent = analysis.metrics.competitiveAdvantage;

            // Populate key competitors
            const keyCompetitorsEl = document.getElementById('keyCompetitors');
            keyCompetitorsEl.innerHTML = analysis.competitors.map(comp => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between mb-2">
                        <div class="font-semibold text-gray-800">${comp.name}</div>
                        <div class="text-xs px-2 py-1 rounded ${
                            comp.type === 'Direct' ? 'bg-red-100 text-red-800' : 
                            comp.type === 'Indirect' ? 'bg-yellow-100 text-yellow-800' : 
                            'bg-blue-100 text-blue-800'
                        }">${comp.type}</div>
                    </div>
                    <div class="text-sm text-gray-600 mb-2">${comp.description}</div>
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-gray-500">Market Share: ${comp.marketShare}</span>
                        <span class="font-medium ${
                            comp.strength === 'Strong' ? 'text-red-600' : 
                            comp.strength === 'Moderate' ? 'text-yellow-600' : 
                            'text-green-600'
                        }">${comp.strength}</span>
                    </div>
                </div>
            `).join('');

            // Populate differentiation strategy
            document.getElementById('differentiationStrategy').innerHTML = 
                analysis.differentiation.map(item => `
                    <div class="flex items-start mb-3 last:mb-0">
                        <div class="text-indigo-600 mr-2 mt-1">‚úì</div>
                        <div class="text-sm text-gray-700">${item}</div>
                    </div>
                `).join('');

            // Populate customer metrics
            document.getElementById('cac').textContent = analysis.metrics.cac;
            document.getElementById('ltv').textContent = analysis.metrics.ltv;
            document.getElementById('ltvCacRatio').textContent = analysis.metrics.ltvCacRatio;

            // Populate customer growth
            const customerGrowth = document.getElementById('customerGrowth');
            customerGrowth.innerHTML = analysis.metrics.customerGrowth.map(item => `
                <div class="flex items-center">
                    <div class="w-32 text-sm text-gray-600">${item.period}</div>
                    <div class="flex-1 bg-gray-200 rounded-full h-6 relative">
                        <div class="bg-indigo-600 h-6 rounded-full flex items-center justify-end pr-3" 
                             style="width: ${item.percentage}%">
                            <span class="text-xs text-white font-semibold">${item.customers}</span>
                        </div>
                    </div>
                </div>
            `).join('');

            // Show payment partnership section if applicable
            if (analysis.isPaymentBusiness) {
                document.getElementById('paymentPartnership').classList.remove('hidden');
                populatePaymentPartnership(analysis.paymentPartnership);
            }

            // Populate resources sections
            populateResourceCard('technologyTools', analysis.resources.technology);
            populateResourceCard('physicalResources', analysis.resources.physical);
            populateResourceCard('marketingChannels', analysis.resources.marketing);
            
            // Populate human resources
            const humanResourcesEl = document.getElementById('humanResources');
            humanResourcesEl.innerHTML = analysis.resources.human.map(item => `
                <div class="flex items-start p-3 bg-purple-50 rounded-lg">
                    <div class="flex-1">
                        <div class="font-medium text-gray-800">${item.role}</div>
                        <div class="text-sm text-gray-600">${item.description}</div>
                    </div>
                    <div class="text-xs px-2 py-1 rounded bg-purple-200 text-purple-800 ml-2">${item.timing}</div>
                </div>
            `).join('');

            // Populate legal requirements
            const legalRequirementsEl = document.getElementById('legalRequirements');
            legalRequirementsEl.innerHTML = analysis.resources.legal.map(item => `
                <div class="flex items-start p-3 bg-red-50 rounded-lg">
                    <div class="flex-1">
                        <div class="font-medium text-gray-800">${item.requirement}</div>
                        <div class="text-sm text-gray-600">${item.details}</div>
                    </div>
                    <div class="text-xs px-2 py-1 rounded ${
                        item.priority === 'Critical' ? 'bg-red-200 text-red-800' : 
                        item.priority === 'Important' ? 'bg-orange-200 text-orange-800' : 
                        'bg-yellow-200 text-yellow-800'
                    } ml-2">${item.priority}</div>
                </div>
            `).join('');

            // Populate text sections with formatting
            document.getElementById('marketAnalysis').innerHTML = formatText(analysis.marketAnalysis || 'Analysis not available');
            document.getElementById('revenueAnalysis').innerHTML = formatText(analysis.revenueAnalysis || 'Analysis not available');
            document.getElementById('competitionAnalysis').innerHTML = formatText(analysis.competitionAnalysis || 'Analysis not available');
            document.getElementById('examplesAnalysis').innerHTML = formatText(analysis.examplesAnalysis || 'Analysis not available');
            document.getElementById('startupGuide').innerHTML = formatText(analysis.startupGuide || 'Analysis not available');
            document.getElementById('riskFactors').innerHTML = formatText(analysis.riskFactors || 'Analysis not available');

            // Scroll to results
            results.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function populateResourceCard(elementId, items) {
            const el = document.getElementById(elementId);
            el.innerHTML = items.map(item => `
                <div class="flex items-start p-3 bg-gray-50 rounded-lg border border-gray-200">
                    <div class="flex-1">
                        <div class="font-medium text-gray-800 text-sm">${item.name}</div>
                        <div class="text-xs text-gray-600 mt-1">${item.purpose}</div>
                    </div>
                    <div class="text-xs text-gray-500 ml-2">${item.cost}</div>
                </div>
            `).join('');
        }

        function formatText(text) {
            // Convert line breaks to paragraphs
            return text
                .split('\n\n')
                .map(para => `<p class="mb-3">${para.replace(/\n/g, '<br>')}</p>`)
                .join('');
        }

        function showError(message) {
            error.classList.remove('hidden');
            document.getElementById('errorMessage').textContent = message;
            error.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Chart creation functions
        let marketGrowthChartInstance = null;
        let revenueChartInstance = null;
        let startupCostsChartInstance = null;

        function createMarketGrowthChart(data) {
            const ctx = document.getElementById('marketGrowthChart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (marketGrowthChartInstance) {
                marketGrowthChartInstance.destroy();
            }
            
            marketGrowthChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Market Size (Billions)',
                        data: data.values,
                        borderColor: 'rgb(79, 70, 229)',
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value + 'B';
                                }
                            }
                        }
                    }
                }
            });
        }

        function createRevenueChart(projections) {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (revenueChartInstance) {
                revenueChartInstance.destroy();
            }
            
            const labels = projections.map(p => p.period);
            const revenue = projections.map(p => parseInt(p.revenue.replace(/[$,]/g, '')));
            const expenses = projections.map(p => parseInt(p.expenses.replace(/[$,]/g, '')));
            const profit = projections.map(p => {
                const val = p.netProfit.replace(/[$,]/g, '');
                return val.startsWith('-') ? -parseInt(val.substring(1)) : parseInt(val);
            });

            revenueChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Revenue',
                            data: revenue,
                            borderColor: 'rgb(34, 197, 94)',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Expenses',
                            data: expenses,
                            borderColor: 'rgb(239, 68, 68)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Net Profit',
                            data: profit,
                            borderColor: 'rgb(99, 102, 241)',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { position: 'top' }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function createStartupCostsChart(costs) {
            const ctx = document.getElementById('startupCostsChart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (startupCostsChartInstance) {
                startupCostsChartInstance.destroy();
            }
            
            const labels = costs.map(c => c.category);
            const data = costs.map(c => {
                const amounts = c.amount.replace(/[$,]/g, '').split(' - ');
                return parseInt(amounts[0]);
            });

            startupCostsChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgb(99, 102, 241)',
                            'rgb(139, 92, 246)',
                            'rgb(236, 72, 153)',
                            'rgb(251, 146, 60)',
                            'rgb(34, 197, 94)',
                            'rgb(14, 165, 233)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: 10 } } }
                    }
                }
            });
        }

        function populatePaymentPartnership(partnership) {
            // Payment providers
            const providersEl = document.getElementById('paymentProviders');
            providersEl.innerHTML = partnership.providers.map(p => `
                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="font-semibold text-gray-800 mb-2">${p.name}</div>
                    <div class="text-xs text-gray-600 mb-2">${p.description}</div>
                    <div class="flex items-center justify-between text-xs">
                        <span class="text-gray-500">Processing Fee:</span>
                        <span class="font-medium text-gray-800">${p.fee}</span>
                    </div>
                    <div class="flex items-center justify-between text-xs mt-1">
                        <span class="text-gray-500">Setup Time:</span>
                        <span class="font-medium text-gray-800">${p.setupTime}</span>
                    </div>
                </div>
            `).join('');

            // Technical requirements
            const technicalEl = document.getElementById('technicalReqs');
            technicalEl.innerHTML = partnership.technicalReqs.map(req => `
                <div class="flex items-start p-3 bg-blue-50 rounded-lg">
                    <div class="flex-1">
                        <div class="font-medium text-gray-800">${req.requirement}</div>
                        <div class="text-sm text-gray-600">${req.details}</div>
                    </div>
                </div>
            `).join('');

            // Compliance requirements
            const complianceEl = document.getElementById('complianceReqs');
            complianceEl.innerHTML = partnership.complianceReqs.map(req => `
                <div class="flex items-start p-3 bg-yellow-50 rounded-lg">
                    <div class="flex-1">
                        <div class="font-medium text-gray-800">${req.requirement}</div>
                        <div class="text-sm text-gray-600">${req.details}</div>
                    </div>
                    <div class="text-xs px-2 py-1 rounded bg-yellow-200 text-yellow-800 ml-2">${req.priority}</div>
                </div>
            `).join('');

            // Financial requirements
            const financialEl = document.getElementById('financialReqs');
            financialEl.innerHTML = partnership.financialReqs.map(req => `
                <div class="flex items-start p-3 bg-green-50 rounded-lg">
                    <div class="flex-1">
                        <div class="font-medium text-gray-800">${req.requirement}</div>
                        <div class="text-sm text-gray-600">${req.details}</div>
                    </div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
